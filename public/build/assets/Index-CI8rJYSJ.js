import{c as g,o as v,a as o,u as xt,r as G,L as j,H as Kt,G as Ie,b as ue,D as Wt,E as Yt,I as rt,e as oe,g as L,w as qt,h as x,t as y,l as Ze,F as ye,j as xe,f as je,v as Be,J as mt,k as de,n as Se,K as ht,T as Xt,q as Qt,p as pe}from"./app-OFDSvyLL.js";import{_ as eo}from"./logo-C5fiQHXv.js";import{i as to,_ as oo,u as ao}from"./_plugin-vue_export-helper-BMGuriYK.js";import{r as Ke}from"./XMarkIcon-D3eyuP7U.js";import{r as yt}from"./MagnifyingGlassIcon-ByEqFNoe.js";/* empty css            */const ro=V=>to(V,'<svg fill="currentColor" viewBox="0 0 24 24"><path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10Zm4.5-14.5L10 10l-2.5 6.5L14 14zM12 13a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"/></svg>');function so(V,F){return v(),g("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}function bt(){const V=(s,b,f,_)=>{const S=s*Math.PI/180,l=f*Math.PI/180,T=(f-s)*Math.PI/180,$=(_-b)*Math.PI/180,P=Math.sin(T/2)*Math.sin(T/2)+Math.cos(S)*Math.cos(l)*Math.sin($/2)*Math.sin($/2);return 6371e3*(2*Math.atan2(Math.sqrt(P),Math.sqrt(1-P)))},F=(s,b,f,_)=>{const E=s*Math.PI/180,S=f*Math.PI/180,l=(_-b)*Math.PI/180,T=Math.sin(l)*Math.cos(S),$=Math.cos(E)*Math.sin(S)-Math.sin(E)*Math.cos(S)*Math.cos(l);return(Math.atan2(T,$)*180/Math.PI+360)%360},m=s=>{const b=[{min:0,max:22.5,text:"north",icon:"‚¨ÜÔ∏è"},{min:22.5,max:67.5,text:"northeast",icon:"‚ÜóÔ∏è"},{min:67.5,max:112.5,text:"east",icon:"‚û°Ô∏è"},{min:112.5,max:157.5,text:"southeast",icon:"‚ÜòÔ∏è"},{min:157.5,max:202.5,text:"south",icon:"‚¨áÔ∏è"},{min:202.5,max:247.5,text:"southwest",icon:"‚ÜôÔ∏è"},{min:247.5,max:292.5,text:"west",icon:"‚¨ÖÔ∏è"},{min:292.5,max:337.5,text:"northwest",icon:"‚ÜñÔ∏è"},{min:337.5,max:360,text:"north",icon:"‚¨ÜÔ∏è"}];for(const f of b)if(s>=f.min&&s<f.max)return f;return b[0]},J=(s,b,f)=>{const _=F(s.lat,s.lng,b.lat,b.lng);let S=F(b.lat,b.lng,f.lat,f.lng)-_;return S>180&&(S-=360),S<-180&&(S+=360),S},te=s=>Math.abs(s)<20?{text:"Continue straight",icon:"‚¨ÜÔ∏è"}:s>20&&s<70?{text:"Turn slight right",icon:"‚ÜóÔ∏è"}:s>=70&&s<120?{text:"Turn right",icon:"‚û°Ô∏è"}:s>=120?{text:"Turn sharp right",icon:"‚Ü™Ô∏è"}:s<-20&&s>-70?{text:"Turn slight left",icon:"‚ÜñÔ∏è"}:s<=-70&&s>-120?{text:"Turn left",icon:"‚¨ÖÔ∏è"}:s<=-120?{text:"Turn sharp left",icon:"‚Ü©Ô∏è"}:{text:"Continue",icon:"‚¨ÜÔ∏è"},Z=(s,b)=>{let f=0,_=1/0;return b.forEach((E,S)=>{const l=V(s.lat,s.lng,E[1],E[0]);l<_&&(_=l,f=S)}),{index:f,coord:b[f],distance:_}},O=(s,b,f=30)=>{let _=null,E=null,S=1/0;return b.forEach(l=>{if(l.geometry.type==="LineString"){const T=l.geometry.coordinates,$=Z(s,T);$.distance<S&&(S=$.distance,_=l,E=$)}}),S<=f?{feature:_,point:E}:null},I=async(s,b,f)=>{try{const E=`https://router.project-osrm.org/route/v1/${f==="driving"?"driving":f==="riding"?"cycling":"walking"}/${s.lng},${s.lat};${b.lng},${b.lat}?overview=full&geometries=geojson`,l=await(await fetch(E)).json();if(l.code==="Ok"&&l.routes.length>0)return l.routes[0].geometry.coordinates.map(([$,P])=>({lat:P,lng:$}))}catch(_){console.error("OSRM routing error:",_)}return null},N=s=>{const b=new Map,f=new Map,_=(E,S)=>{const l=`${E.toFixed(6)},${S.toFixed(6)}`;if(!f.has(l)){const T=`node_${f.size}`;f.set(l,T),b.set(T,{id:T,lat:E,lng:S,neighbors:[]})}return f.get(l)};return s.forEach(E=>{if(E.geometry.type!=="LineString")return;const S=E.geometry.coordinates;let l=null;S.forEach(([T,$])=>{const P=_($,T),w=b.get(P);if(l){const K=b.get(l),Q=V(K.lat,K.lng,$,T);w.neighbors.some(se=>se.id===l)||w.neighbors.push({id:l,cost:Q}),K.neighbors.some(se=>se.id===P)||K.neighbors.push({id:P,cost:Q})}l=P})}),console.log(`Built graph with ${b.size} nodes`),b},q=(s,b,f=100)=>{let _=null,E=1/0;for(const[S,l]of b.entries()){const T=V(s.lat,s.lng,l.lat,l.lng);T<E&&T<=f&&(E=T,_=S)}return _},r=(s,b,f)=>{if(!f.has(s)||!f.has(b))return console.warn("Start or goal node not in graph"),null;if(s===b){const W=f.get(s);return[{lat:W.lat,lng:W.lng}]}const _=new Set,E=new Map,S=new Map,l=new Map;class T{constructor(){this.heap=[]}push(U,p){this.heap.push({item:U,priority:p}),this.bubbleUp(this.heap.length-1)}pop(){if(this.heap.length===0)return null;const U=this.heap[0].item,p=this.heap.pop();return this.heap.length>0&&(this.heap[0]=p,this.bubbleDown(0)),U}bubbleUp(U){for(;U>0;){const p=Math.floor((U-1)/2);if(this.heap[U].priority>=this.heap[p].priority)break;[this.heap[U],this.heap[p]]=[this.heap[p],this.heap[U]],U=p}}bubbleDown(U){for(;;){let p=U;const ne=2*U+1,H=2*U+2;if(ne<this.heap.length&&this.heap[ne].priority<this.heap[p].priority&&(p=ne),H<this.heap.length&&this.heap[H].priority<this.heap[p].priority&&(p=H),p===U)break;[this.heap[U],this.heap[p]]=[this.heap[p],this.heap[U]],U=p}}isEmpty(){return this.heap.length===0}}const $=new T;S.set(s,0);const P=f.get(s),w=f.get(b),K=(W,U)=>V(W.lat,W.lng,U.lat,U.lng)*.95;l.set(s,K(P,w)),$.push(s,l.get(s));let Q=0;const se=f.size*2;for(;!$.isEmpty()&&Q<se;){Q++;const W=$.pop();if(W===b)return console.log(`‚úÖ Path found in ${Q} iterations`),M(E,W,f);if(_.has(W))continue;_.add(W);const U=f.get(W);if(!U)continue;const p=S.get(W)||1/0;for(const ne of U.neighbors){const H=ne.id;if(_.has(H))continue;const le=f.get(H);if(!le)continue;const ge=p+ne.cost;if(!S.has(H)||ge<S.get(H)){E.set(H,W),S.set(H,ge);const Me=ge+K(le,w);l.set(H,Me),$.push(H,Me)}}}return console.warn(`‚ö†Ô∏è No path found after ${Q} iterations`),null},M=(s,b,f)=>{const _=[];let E=b;for(;E;){const S=f.get(E);_.unshift({lat:S.lat,lng:S.lng}),E=s.get(E)}return _};return{calculateDistance:V,calculateBearing:F,getDirection:m,calculateTurnAngle:J,getTurnInstruction:te,getNearestPointOnLine:Z,findClickedLineString:O,getPublicRoute:I,buildCampusGraph:N,findNearestNode:q,findPathAStar:r,calculateRouteDistance:s=>{let b=0;for(let f=0;f<s.length-1;f++)b+=V(s[f].lat,s[f].lng,s[f+1].lat,s[f+1].lng);return b},findCampusEntrances:s=>{const b=[];for(const[f,_]of s.entries())b.push({id:f,lat:_.lat,lng:_.lng,node:_});return b},generateEnhancedInstructions:(s,b)=>{if(!s||s.length<2)return[{icon:"üìç",text:"You are at your destination",distance:"0 m"}];const f=[];let _=0;const E=7,S=F(s[0].lat,s[0].lng,s[1].lat,s[1].lng),l=m(S);f.push({icon:"üö∂",text:`Start heading ${l.text}`,distance:"0 m",bearing:S.toFixed(0)+"¬∞"});let T=0;for(let w=0;w<s.length-1;w++)T+=V(s[w].lat,s[w].lng,s[w+1].lat,s[w+1].lng);const $=[];_=0;for(let w=1;w<s.length-1;w++){const K=V(s[w-1].lat,s[w-1].lng,s[w].lat,s[w].lng);_+=K;const Q=J(s[w-1],s[w],s[w+1]);if(Math.abs(Q)>20){const se=F(s[w].lat,s[w].lng,s[w+1].lat,s[w+1].lng);$.push({index:w,angle:Q,distance:_,bearing:se})}}if(b&&T>100){const w=T/2;f.push({icon:"üè´",text:"Enter campus grounds",distance:`${Math.round(w)} m`})}const P=E-2-(b?1:0);return $.length>P&&($.sort((w,K)=>Math.abs(K.angle)-Math.abs(w.angle)),$.splice(P),$.sort((w,K)=>w.distance-K.distance)),$.forEach(w=>{const K=te(w.angle);f.push({icon:K.icon,text:K.text,distance:`${Math.round(w.distance)} m`,bearing:w.bearing.toFixed(0)+"¬∞"})}),f.push({icon:"üéØ",text:"You have arrived at your destination",distance:`${Math.round(T)} m`}),f.length>E?[f[0],...f.slice(-Math.min(5,E-2)),f[f.length-1]].slice(0,E):f}}}function no(){const V=xt(),{calculateDistance:F}=bt(),m=G(null),J=G(null),te=G(null),Z=G(null),O=(r,M)=>{if(!(!M||!r||!r.accuracy))try{Z.value&&M.hasLayer&&M.hasLayer(Z.value)&&(M.removeLayer(Z.value),Z.value=null),r.accuracy<100&&(Z.value=j.circle([r.lat,r.lng],{radius:r.accuracy,color:"#3388ff",fillColor:"#3388ff",fillOpacity:.1,weight:1,opacity:.5}).addTo(M),Z.value.bindTooltip(`GPS Accuracy: ${Math.round(r.accuracy)}m`,{permanent:!1,direction:"top",offset:[0,-10]}))}catch(R){console.warn("Error updating accuracy circle:",R)}},I=(r,M,R)=>{if(!m.value||!M){console.warn("Cannot update user marker: missing location or map");return}try{if(J.value&&typeof J.value.setLatLng=="function"&&M.hasLayer&&M.hasLayer(J.value)){J.value.setLatLng([m.value.lat,m.value.lng]);const C=`
          <div style="font-size: 13px; color: #1f2937; font-weight: 500;">
            ${r.nickname||"You"}
            ${m.value.accuracy?`<br><small style="color: #6b7280;">Accuracy: ${Math.round(m.value.accuracy)}m</small>`:""}
          </div>
        `;J.value.setPopupContent(C)}else{console.log("Creating new user marker..."),J.value=j.marker([m.value.lat,m.value.lng],{title:r.nickname||"You",draggable:!0,autoPan:!0,zIndexOffset:1e3,icon:j.divIcon({className:"user-location-marker",html:`
              <div style="
                background: #3388ff;
                border: 3px solid white;
                border-radius: 50%;
                width: 20px;
                height: 20px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.3);
                animation: pulse 2s infinite;
              "></div>
            `,iconSize:[20,20],iconAnchor:[10,10]})}).addTo(M),J.value.on("dragend",z=>{const b=z.target.getLatLng();m.value={lat:parseFloat(b.lat.toFixed(8)),lng:parseFloat(b.lng.toFixed(8)),accuracy:m.value?.accuracy||10,isManual:!0},console.log("Marker dragged to:",m.value),O(m.value,M),R&&R(m.value),V.info("Location updated manually")});const C=`
          <div style="font-size: 13px; color: #1f2937; font-weight: 500;">
            ${r.nickname||"You"}
            ${m.value.accuracy?`<br><small style="color: #6b7280;">Accuracy: ${Math.round(m.value.accuracy)}m</small>`:""}
            ${m.value.isManual?'<br><small style="color: #f59e0b;">üìç Manually placed</small>':""}
          </div>
        `;J.value.bindPopup(C,{offset:[0,-12],closeButton:!1,autoPan:!1,className:"user-popup"}),r.nickname&&setTimeout(()=>{J.value&&!J.value.isPopupOpen()&&(J.value.openPopup(),setTimeout(()=>J.value.closePopup(),3e3))},1e3)}}catch(C){console.error("Error updating user marker:",C),J.value=null}},N=(r,M,R)=>{if(!navigator.geolocation){console.error("Geolocation not supported"),V.error("Geolocation is not supported by your browser");return}if(!M){console.warn("Cannot start tracking: map not initialized");return}console.log("Starting GPS tracking with real-time updates..."),te.value=navigator.geolocation.watchPosition(C=>{if(!M){console.warn("Map destroyed during GPS update, stopping tracking"),q(M);return}const z={lat:parseFloat(C.coords.latitude.toFixed(8)),lng:parseFloat(C.coords.longitude.toFixed(8)),accuracy:C.coords.accuracy,heading:C.coords.heading,speed:C.coords.speed};if(console.log("GPS Update:",{position:`${z.lat.toFixed(8)}, ${z.lng.toFixed(8)}`,accuracy:`${Math.round(z.accuracy)}m`,heading:z.heading,speed:z.speed}),m.value){const s=F(m.value.lat,m.value.lng,z.lat,z.lng),b=z.accuracy<m.value.accuracy*.7;(s>2||b)&&(m.value=z,I(r,M,R),O(z,M),R&&R(z))}else m.value=z,I(r,M,R),O(z,M),V.success(`GPS acquired! Accuracy: ${Math.round(z.accuracy)}m`)},C=>{console.error("Geolocation watch error:",C);let z="GPS signal lost";switch(C.code){case C.PERMISSION_DENIED:z="GPS permission denied. Please enable location services.";break;case C.POSITION_UNAVAILABLE:z="GPS position unavailable. Check your location settings.";break;case C.TIMEOUT:z="GPS timeout. Trying to reconnect...",setTimeout(()=>N(r,M,R),2e3);break}console.warn(z),m.value||(m.value={lat:8.169,lng:126.003},I(r,M,R))},{enableHighAccuracy:!0,timeout:5e3,maximumAge:2e3})},q=r=>{if(te.value!==null&&(navigator.geolocation.clearWatch(te.value),te.value=null,console.log("GPS tracking stopped")),Z.value&&r&&r.hasLayer&&r.hasLayer(Z.value)){try{r.removeLayer(Z.value)}catch(M){console.warn("Error removing accuracy circle:",M)}Z.value=null}if(J.value&&r&&r.hasLayer&&r.hasLayer(J.value)){try{r.removeLayer(J.value)}catch(M){console.warn("Error removing user marker:",M)}J.value=null}};return{userLocation:m,userMarker:J,watchId:te,accuracyCircle:Z,startTracking:N,stopTracking:q,updateUserMarker:I,updateAccuracyCircle:O}}function lo(){const V=G([]),F=G([]);return{facilityMarkers:V,polygonLayers:F,markerTypeIcons:{academic:"üéì",library:"üìö",laboratory:"üî¨",office:"üíº",cafeteria:"üçΩÔ∏è",sports:"üèÉ",dormitory:"üõèÔ∏è",parking:"üöó",medical:"‚öïÔ∏è",building:"üèõÔ∏è",classroom:"‚úèÔ∏è",administration:"üìã",auditorium:"üé≠",gymnasium:"üèÄ",theater:"üé¨",studio:"üé®",workshop:"üîß",conference:"üë•",entrance:"üö™",exit:"üö∂",restroom:"üöª",garden:"üå≥",plaza:"üèûÔ∏è",fountain:"‚õ≤",statue:"üóø",gate:"üöß",security:"üîí",it:"üíª",maintenance:"üõ†Ô∏è",storage:"üì¶",default:"üìå"},addFacilityMarker:(O,I)=>{if(!I||!I.addLayer){console.warn("Cannot add marker: map not ready");return}try{const N=j.marker([O.lat,O.lng],{title:O.name,icon:j.divIcon({className:"facility-marker",html:`
            <div style="
              background: white;
              border: 1px solid #3B82F6;
              border-radius: 50%;
              width: 20px;
              height: 20px;
              display: flex;
              align-items: center;
              justify-content: center;
              box-shadow: 0 2px 8px rgba(0,0,0,0.3);
              font-size: 16px;
            ">
              ${O.icon}
            </div>
          `,iconSize:[40,40],iconAnchor:[20,20]})}).addTo(I);return V.value.push(N),N}catch(N){return console.error("Error adding facility marker:",N),null}},displayPolygons:(O,I)=>{if(!I||!O||!Array.isArray(O)){console.warn("Cannot display polygons: map or data not ready");return}F.value.forEach(N=>{if(I&&I.hasLayer&&I.hasLayer(N))try{I.removeLayer(N)}catch(q){console.warn("Error removing polygon layer:",q)}}),F.value=[],O.forEach(N=>{if(!N.coordinates||!Array.isArray(N.coordinates)){console.warn("Invalid polygon coordinates:",N);return}try{const q=N.coordinates.map(M=>[M.lat,M.lng]),r=j.polygon(q,{color:N.color||"#3B82F6",fillColor:N.fill_color||"#3B82F6",fillOpacity:N.fill_opacity||.3,weight:3,opacity:.9,lineCap:"round",lineJoin:"round"});N.name&&r.bindTooltip(N.name,{permanent:!1,direction:"center",className:"polygon-tooltip",opacity:.9}),r.on("mouseover",function(M){M.target.setStyle({fillOpacity:.5,weight:4})}),r.on("mouseout",function(M){M.target.setStyle({fillOpacity:N.fill_opacity||.3,weight:3})}),I&&I.addLayer&&(r.addTo(I),F.value.push(r))}catch(q){console.error("Error creating polygon:",N,q)}})},cleanup:O=>{O&&(V.value.forEach(I=>{if(O.hasLayer&&O.hasLayer(I))try{O.removeLayer(I)}catch(N){console.warn("Error removing facility marker:",N)}}),V.value=[],F.value.forEach(I=>{if(O.hasLayer&&O.hasLayer(I))try{O.removeLayer(I)}catch(N){console.warn("Error removing polygon layer:",N)}}),F.value=[])}}}const io={class:"relative flex h-screen w-full"},co={key:0,class:"z-20 flex flex-col border-gray-200 bg-white shadow-xl fixed bottom-0 left-0 right-0 max-h-[85vh] rounded-t-2xl md:relative md:h-full md:w-full md:max-w-md md:border-r md:rounded-none md:max-h-full"},uo={class:"relative border-b border-gray-200 bg-white shadow-sm"},po={class:"px-4 py-3"},go={class:"flex items-start justify-between gap-3"},vo={class:"flex-1 min-w-0"},fo={class:"flex items-center gap-3 mb-2"},mo={class:"flex-shrink-0 flex items-center justify-center w-10 h-10 rounded-lg bg-gray-50 border border-gray-200 text-2xl shadow-sm"},ho={class:"min-w-0"},yo={class:"text-sm font-bold text-gray-900 leading-tight truncate"},xo={class:"flex items-center gap-2 mt-0.5"},bo={class:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-green-50 text-green-700 border border-green-100 uppercase tracking-wide"},wo={key:0,class:"text-[10px] text-gray-500 truncate"},ko={class:"grid grid-cols-2 gap-x-2 gap-y-1.5 mt-2 bg-gray-50/50 rounded-md p-2 border border-gray-100"},_o={key:0,class:"flex items-center gap-1.5 min-w-0"},So={class:"text-[11px] font-medium text-gray-700 truncate",title:"Location"},Mo={key:1,class:"flex items-center gap-1.5 min-w-0"},Co={class:"text-[11px] font-medium text-gray-700 truncate"},Eo={key:2,class:"col-span-2 flex items-start gap-1.5 min-w-0 pt-1 border-t border-gray-100"},Lo={class:"text-[11px] font-medium text-gray-700 leading-snug"},Po={class:"flex-1 overflow-y-auto bg-gray-50"},Io={class:"space-y-4 px-4 py-4 bg-white"},No={key:0,class:"text-sm leading-relaxed text-gray-600"},$o={class:"flex flex-wrap gap-2"},Ao={key:1,class:"rounded-lg border border-gray-200 bg-white shadow-sm"},Fo={class:"whitespace-pre-line px-3 py-3 text-sm text-gray-700"},To={key:2,class:"rounded-lg border border-gray-200 bg-white shadow-sm"},Do={class:"mt-0.5 text-lg"},Ro={class:"flex-1"},zo={class:"text-sm font-medium text-gray-800"},Go={class:"text-xs text-gray-500"},jo={class:"border-t border-gray-200 px-4 py-4 bg-white"},Bo={class:"mb-3 flex items-center justify-between"},Oo={class:"text-xs text-gray-500"},Uo={class:"space-y-3"},Vo={class:"rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 p-4 text-center hover:border-gray-400 transition"},Jo={key:0,class:"space-y-2"},Ho={key:1,class:"space-y-3"},Zo=["src"],Ko={class:"flex justify-end gap-2"},Wo=["disabled"],Yo={key:0,class:"space-y-3"},qo={class:"grid grid-cols-2 gap-3"},Xo=["onClick"],Qo=["src","alt"],ea={class:"space-y-1 px-3 py-2 bg-gray-50"},ta={class:"text-xs font-medium text-gray-900 truncate"},oa={class:"text-[11px] text-gray-500"},aa={key:1,class:"text-center text-sm text-gray-500"},ra={class:"border-t border-gray-200 px-4 py-4 space-y-3 bg-white"},sa={class:"flex items-center justify-between"},na={class:"text-xs text-gray-500"},la={class:"text-xs text-gray-500 bg-green-50 border border-green-200 rounded-lg px-3 py-2 space-y-1"},ia={key:0,class:"space-y-2 rounded-lg border border-gray-300 bg-gray-50 p-3 shadow-sm"},ca={class:"flex justify-end gap-2"},ua=["disabled"],da={key:1},pa={key:2,class:"space-y-3"},ga={class:"flex items-start justify-between gap-3"},va={class:"text-xs font-semibold text-gray-700"},fa={key:0,class:"text-green-700"},ma={class:"text-xs text-gray-500"},ha=["onClick"],ya={class:"mt-2 text-sm text-gray-800 leading-relaxed"},xa={key:3,class:"text-center text-sm text-gray-500"},ba={class:"border-t border-gray-200 px-4 py-4 space-y-3 bg-white"},wa={class:"flex items-center justify-between"},ka={class:"text-xs text-gray-500"},_a={key:0,class:"space-y-2 rounded-lg border border-gray-300 bg-gray-50 p-3 shadow-sm"},Sa={class:"flex justify-end gap-2"},Ma=["disabled"],Ca={key:1},Ea={key:2,class:"space-y-2"},La={class:"max-h-60 overflow-y-auto space-y-3 pr-2 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100"},Pa={class:"flex items-center justify-between"},Ia={class:"text-sm font-semibold text-gray-800"},Na={class:"text-xs text-gray-500"},$a={class:"mt-2 text-sm text-gray-700"},Aa={key:3,class:"text-sm text-gray-500 text-center"},Fa={class:"relative flex-1"},Ta={key:0,class:"absolute top-4 left-4 right-4 sm:left-1/2 sm:right-auto sm:-translate-x-1/2 sm:transform z-10 sm:w-full sm:max-w-2xl sm:px-4"},Da={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},Ra={class:"relative"},za={class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3.5"},Ga={key:0,class:"border-t border-gray-200 bg-white"},ja={key:0,class:"px-4 py-8 text-center"},Ba={key:1,class:"px-4 py-8 text-center"},Oa={class:"w-12 h-12 mx-auto rounded-full bg-gray-100 flex items-center justify-center"},Ua={key:2,class:"max-h-[70vh] overflow-y-auto"},Va={class:"sticky top-0 z-10 bg-white px-4 py-2 border-b border-gray-100"},Ja={class:"text-[10px] font-semibold text-gray-500 uppercase tracking-wider"},Ha={class:"divide-y divide-gray-100"},Za=["onClick"],Ka={class:"flex-shrink-0 w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center group-hover:bg-green-50 transition-colors"},Wa={class:"text-lg group-hover:scale-105 transition-transform"},Ya={class:"min-w-0 flex-1 space-y-2"},qa={class:"flex items-start justify-between gap-2"},Xa={class:"font-semibold text-gray-900 text-xs leading-tight group-hover:text-green-700 transition-colors"},Qa={class:"flex-shrink-0 text-[10px] font-medium text-gray-500 bg-gray-100 px-2 py-0.5 rounded"},er={class:"flex flex-wrap items-center gap-1.5"},tr={class:"inline-flex items-center px-2 py-0.5 rounded-md bg-green-50 border border-green-200 text-green-700 text-[10px] font-medium"},or={class:"inline-flex items-center px-2 py-0.5 rounded-md bg-blue-50 border border-blue-200 text-blue-700 text-[10px] font-medium"},ar={key:0,class:"text-[11px] text-gray-600 leading-relaxed line-clamp-2"},rr={key:1,class:"grid grid-cols-2 gap-x-4 gap-y-1 pt-1 border-t border-gray-100"},sr={key:0,class:"flex items-center gap-1.5"},nr={class:"text-[10px] text-gray-600"},lr={class:"font-medium text-gray-900"},ir={key:1,class:"flex items-center gap-1.5"},cr={class:"text-[10px] text-gray-600"},ur={class:"font-medium text-gray-900"},dr={key:2,class:"flex items-center gap-1.5"},pr={class:"text-[10px] text-gray-600 capitalize"},gr={key:3,class:"flex items-center gap-1.5"},vr={class:"text-[10px] text-gray-600"},fr={key:1,class:"absolute bottom-4 left-4 z-10"},mr={class:"flex max-w-[calc(100vw-6rem)] flex-wrap gap-1 rounded-lg bg-white p-1.5 shadow-lg sm:max-w-none sm:p-2"},hr=["onClick","title"],yr={class:"text-base sm:text-lg"},xr={class:"hidden text-xs lg:inline"},br={key:2,class:"absolute top-4 right-4 z-10"},wr={class:"flex items-center gap-2 rounded-lg bg-white px-3 py-2 shadow-lg sm:px-4"},kr={class:"hidden text-left sm:block"},_r={class:"max-w-[120px] truncate text-xs font-semibold text-gray-900"},Sr={class:"text-xs text-gray-500"},Mr={key:3,class:"absolute left-4 top-20 hidden w-64 rounded-lg border border-gray-200 bg-white shadow-lg sm:block sm:w-72"},Cr={class:"flex items-center justify-between border-b border-gray-200 bg-green-900 px-3 py-2"},Er={class:"max-h-40 overflow-y-auto px-3 py-2 text-xs leading-relaxed text-gray-700"},Lr={key:4,class:"absolute bottom-20 left-4 right-4 z-20 flex max-h-52 flex-col overflow-hidden rounded-lg border border-gray-200 bg-white shadow-lg sm:bottom-4 sm:left-auto sm:w-72"},Pr={class:"flex items-center justify-between border-b border-gray-200 bg-green-900 px-3 py-2"},Ir={class:"mt-0.5 text-sm"},Nr={class:"min-w-0 flex-1"},$r={class:"font-medium text-gray-900"},Ar={class:"text-gray-500"},Fr={key:0,class:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 p-4"},Tr={class:"relative w-full max-w-sm rounded-lg bg-white shadow-2xl"},Dr={key:0,class:"p-6 sm:p-8"},Rr={class:"space-y-4"},zr=["disabled"],Gr={key:1,class:"p-6 sm:p-8"},jr={class:"mb-6 space-y-3"},Br=["onClick"],Or={class:"text-xl sm:text-2xl"},Ur={class:"text-sm font-medium text-gray-900"},Vr={class:"space-y-2"},Jr=["disabled"],Hr={class:"relative bg-white rounded-lg overflow-hidden shadow-2xl"},Zr=["src","alt"],Kr={class:"bg-gray-50 px-6 py-4 border-t border-gray-200"},Wr={key:0,class:"text-sm font-medium text-gray-900 mb-1"},Yr={class:"text-xs text-gray-600"},qr={class:"text-xs text-gray-500 mt-1"},Oe="localStorage",Xr={__name:"GuestMapV2",props:{facilities:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},polygons:{type:Array,default:()=>[]}},setup(V){const F=V,m=xt(),J=ao(),{isSearching:te,showSearchResults:Z,showGuestModal:O,isGuestInfoComplete:I,showInstructions:N,isSavingFeedback:q,map:r,searchQuery:M,destinationMarker:R,routePolyline:C,routeInfo:z,privateRoutes:s,guestStep:b,selectedMarker:f,feedback:_,message:E,filteredLocations:S,selectedLocation:l,geoJsonLayers:T,navigationInstructions:$}=Kt(J),P=bt(),w=no(),{addFacilityMarker:K,displayPolygons:Q,markerTypeIcons:se,facilityMarkers:W,polygonLayers:U}=lo(),p=G({id:null,nickname:"",role:""}),ne=G(null),H=G("walking"),le=G(null),ge=G(null),Me=[{value:"walking",label:"Walking",icon:"üö∂",speed:5},{value:"riding",label:"Riding",icon:"üö¥",speed:15},{value:"driving",label:"Driving",icon:"üöó",speed:40}],ve=G([]),wt=[{value:"student",label:"Student",icon:"üéì"},{value:"faculty",label:"Faculty",icon:"üë®‚Äçüè´"},{value:"visitor",label:"Visitor",icon:"üë§"}],ee=G([]),be=G([]),ae=G({}),fe=G(!1),We=G(!1),Ue=G(null),me=G(null),Ne=G(""),Ve=G(!1),ie=G(""),Je=G(!1),$e=G(null),Ce=G(!1),Ae=G(!1),Ye=G(!1),X=G(0),Ee=G(!1),Fe=G("navigation"),st=()=>{const e=[];Array.isArray(F.facilities)&&F.facilities.forEach(t=>{const i=t?.marker?.feedbacks;Array.isArray(i)&&i.forEach(c=>{c&&e.push(c)})}),be.value=e},nt=()=>{const e={};Array.isArray(F.facilities)&&F.facilities.forEach(t=>{!t||!t.id||(e[t.id]=Array.isArray(t.photos)?[...t.photos]:[])}),ae.value=e};st(),nt();const kt=async e=>{if(e)try{const t=await pe.get(`/pub/facilities/${e}/photos`);ae.value={...ae.value,[e]:Array.isArray(t.data?.photos)?t.data.photos:[]}}catch(t){console.error("Error fetching facility photos:",t)}};Ie(()=>F.notes,e=>{ee.value=Array.isArray(e)?[...e]:[]},{deep:!0}),Ie(()=>F.facilities,()=>{st(),nt()},{deep:!0});const Le=ue(()=>l.value?.id??null),Te=ue(()=>l.value?.marker_id??l.value?.marker?.id??null),qe=ue(()=>{if(!Le.value)return[];const e=ae.value[Le.value]||[];return!Ee.value&&e.length>2?e.slice(0,2):e}),ce=ue(()=>Le.value?ae.value[Le.value]||[]:[]),Pe=ue(()=>{if(!Le.value)return{displayed:0,total:0};const e=ae.value[Le.value]||[];return{displayed:qe.value.length,total:e.length}}),De=ue(()=>Te.value?ee.value.filter(e=>e.marker_id===Te.value):[]),Xe=ue(()=>Te.value?be.value.filter(e=>e.marker_id===Te.value):[]),_t=ue(()=>!Te.value||!p.value.id?!1:De.value.some(e=>e.guest_id===p.value.id)),St=((e,t)=>{let i;return(...c)=>{clearTimeout(i),i=setTimeout(()=>e(...c),t)}})(async e=>{if(!(!e.trim()||!p.value.id))try{await pe.post("/search-logs",{guest_id:p.value.id,query:e.trim(),search_at:new Date().toISOString()}),console.log("Search logged successfully")}catch(t){console.error("Failed to log search:",t)}},500);Ie($,()=>{ge.value&&(ge.value.scrollTop=0)},{deep:!0}),Ie(M,e=>{e.length>0&&St(e),e.length>0?(te.value=!0,S.value=re.value.filter(t=>t.name&&t.name.toLowerCase().includes(e.toLowerCase())||t.department&&t.department.toLowerCase().includes(e.toLowerCase())||t.description&&t.description.toLowerCase().includes(e.toLowerCase())||t.floor_number&&t.floor_number.toLowerCase().includes(e.toLowerCase())||t.category&&t.category.toLowerCase().includes(e.toLowerCase())),Z.value=!0):(Z.value=!1,S.value=[]),te.value=!1});const lt=()=>{ne.value=setInterval(()=>{const e=sessionStorage.getItem("guestInfo");if(e)try{const t=JSON.parse(e);t.expiresAt&&Date.now()>t.expiresAt&&(console.log("‚è±Ô∏è Session expired, reloading page..."),it())}catch(t){console.error("Error checking session:",t),it()}},6e4)},it=()=>{sessionStorage.removeItem("guestInfo"),window.location.reload()},Mt=()=>{const e=sessionStorage.getItem("guestInfo");if(e)try{const t=JSON.parse(e);return t.expiresAt&&Date.now()>t.expiresAt?(console.log("‚è±Ô∏è Session expired, clearing stored data"),sessionStorage.removeItem("guestInfo"),!1):(p.value=t,I.value=!0,O.value=!1,lt(),!0)}catch(t){console.error("Error parsing guest info:",t),sessionStorage.removeItem("guestInfo")}return!1},re=ue(()=>!F.facilities||!Array.isArray(F.facilities)?(console.warn("No facilities data"),[]):F.facilities.filter(e=>e&&e.marker&&e.marker.longitude!==null&&e.marker.latitude!==null&&!isNaN(parseFloat(e.marker.longitude))&&!isNaN(parseFloat(e.marker.latitude))).map(e=>{try{const t=e.marker?.type?.toLowerCase()||"default";return{id:e.id,marker_id:e.marker.id,name:e.name||"Unnamed Facility",lng:parseFloat(e.marker.longitude),lat:parseFloat(e.marker.latitude),department:e.marker?.type||"Unknown",markerType:t,category:e.category||"General",description:e.description||"",floor_number:e.floor_number?String(e.floor_number):"",hours:e.hours||"Not specified",icon:se[t]||se.default,marker:e.marker,photos:Array.isArray(e.photos)?e.photos:[],feedbacks:e.marker?.feedbacks||[]}}catch(t){return console.error("Error processing facility:",e,t),null}}).filter(e=>e!==null)),ct=()=>{if(!p.value.nickname.trim()){m.error("Please enter your nickname");return}b.value=2},Ct=()=>{b.value=1},Et=async()=>{if(!p.value.nickname||!p.value.role){m.error("Please complete all steps");return}try{const t=(await pe.post("/guests",{name:p.value.nickname,role:p.value.role})).data;p.value.id=t.id;const i={...p.value,expiresAt:Date.now()+1440*60*1e3};sessionStorage.setItem("guestInfo",JSON.stringify(i)),I.value=!0,O.value=!1,m.success(`Welcome, ${p.value.nickname}!`),lt(),r.value?w.userLocation.value?w.updateUserMarker(p.value,r.value,at):w.startTracking(p.value,r.value,at):await gt()}catch(e){console.error("Error saving guest info:",e),m.error(e.response?.data?.message||"Failed to save guest information")}},Lt=e=>{const t=Me.find(n=>n.value===H.value),c=(t?t.speed:5)*1e3/3600,k=e/c,a=Math.ceil(k/60),u=new Date,h=new Date(u.getTime()+k*1e3);return{minutes:a,arrivalTime:h.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}},Pt=(e,t)=>P.generateEnhancedInstructions(e,t),Re=(e,{centerOnMap:t=!0}={})=>{if(!e)return;const i=l.value&&l.value.id===e.id;if(f.value=e,l.value=e,fe.value=!0,!i){_.value="",ie.value="",Ce.value=!1,ze(),Ee.value=!1;const c=localStorage,k=`facility_notes_${e.id}`,a=c.getItem(k);if(a)try{const u=JSON.parse(a),h=Date.now(),n=u.filter(D=>!(D.expiresAt&&D.expiresAt<h));n.length!==u.length&&c.setItem(k,JSON.stringify(n));const d=new Set(n.map(D=>D.id)),A=ee.value.filter(D=>!d.has(D.id));ee.value=[...n,...A]}catch(u){console.warn("Error parsing stored notes:",u)}}if(e.id&&kt(e.id),t&&r.value)try{r.value.panTo([e.lat,e.lng],{animate:!0})}catch(c){console.warn("Failed to pan to location:",c)}},It=()=>{fe.value=!1},Nt=()=>{if(!l.value||!r.value){m.error("Select a destination first");return}we(j.latLng(l.value.lat,l.value.lng),l.value)},we=async(e,t=null,i=null)=>{if(!w.userLocation.value){m.error("Waiting for GPS location...");return}if(t?(!l.value||l.value.id!==t.id||!fe.value)&&Re(t,{centerOnMap:!1}):(fe.value=!1,l.value=null),C.value&&r.value){try{r.value.hasLayer(C.value)&&r.value.removeLayer(C.value)}catch(n){console.warn("Error removing route polyline:",n)}C.value=null}if(R.value&&r.value){try{r.value.hasLayer(R.value)&&r.value.removeLayer(R.value)}catch(n){console.warn("Error removing destination marker:",n)}R.value=null}r.value&&r.value.closePopup();const c={lat:w.userLocation.value.lat,lng:w.userLocation.value.lng},k={lat:e.lat,lng:e.lng};if(le.value={lat:c.lat,lng:c.lng},console.log("Calculating optimal route..."),s.value&&s.value.features){const n=P.findClickedLineString(k,s.value.features,30);if(n){console.log("User clicked on a campus path! Using hybrid route...");const d=n.feature.geometry.coordinates,A=n.point,D={lat:d[0][1],lng:d[0][0]},B=await P.getPublicRoute(c,D,H.value);let Y=[];B&&B.length>0?Y=[...B]:Y=[c,D];for(let _e=0;_e<=A.index;_e++){const[He,Zt]=d[_e];Y.push({lat:Zt,lng:He})}ke(Y,"hybrid",!0,i),console.log("Hybrid route to campus path completed");return}}if(!s.value||!s.value.features||s.value.features.length===0){console.warn("No campus paths available, using public route only");const n=await P.getPublicRoute(c,k,H.value);n?ke(n,"public",!1,i):ke([c,k],"direct",!1,i);return}const a=P.buildCampusGraph(s.value.features);if(a.size===0){console.warn("Campus graph is empty, using public route only");const n=await P.getPublicRoute(c,k,H.value);n?ke(n,"public",!1,i):ke([c,k],"direct",!1,i);return}const u=[];try{const n=await P.getPublicRoute(c,k,H.value);if(n&&n.length>0){const d=P.calculateRouteDistance(n);u.push({type:"public",route:n,distance:d,isPrivate:!1}),console.log(`Public route: ${Math.round(d)}m`)}}catch(n){console.error("Public route error:",n)}try{const n=P.findNearestNode(c,a,100),d=P.findNearestNode(k,a,100);if(n&&d){console.log(`üîç Trying A* from ${n} to ${d}`);const A=P.findPathAStar(n,d,a);if(A&&A.length>0){const D=P.calculateRouteDistance(A);u.push({type:"private",route:A,distance:D,isPrivate:!0}),console.log(`Campus route: ${Math.round(D)}m`)}}}catch(n){console.error("Campus route error:",n)}try{const n=P.findCampusEntrances(a);if(n.length>0){const d=n.reduce((A,D)=>{const B=P.calculateDistance(k.lat,k.lng,D.lat,D.lng);return B<A.distance?{entrance:D,distance:B}:A},{entrance:null,distance:1/0});if(d.entrance&&d.distance<200){const A={lat:d.entrance.lat,lng:d.entrance.lng},D=await P.getPublicRoute(c,A,H.value);if(D&&D.length>0){const B=P.findNearestNode(k,a,100);if(B){const Y=P.findPathAStar(d.entrance.id,B,a);if(Y&&Y.length>0){const _e=[...D,...Y],He=P.calculateRouteDistance(_e);u.push({type:"hybrid",route:_e,distance:He,isPrivate:!0}),console.log(`Hybrid route: ${Math.round(He)}m`)}}}}}}catch(n){console.error("Hybrid route error:",n)}if(u.length===0){console.warn("All routing failed, using direct line"),ke([c,k],"direct",!1);return}const h=u.reduce((n,d)=>d.distance<n.distance?d:n);console.log(`Selected: ${h.type.toUpperCase()} route (${Math.round(h.distance)}m)`),ke(h.route,h.type,h.isPrivate)},ke=(e,t,i,c=null)=>{if(!r.value){console.warn("Cannot draw route: map not initialized");return}if(C.value){try{r.value.hasLayer(C.value)&&r.value.removeLayer(C.value)}catch(B){console.warn("Error removing old route polyline:",B)}C.value=null}if(R.value){try{r.value.hasLayer(R.value)&&r.value.removeLayer(R.value)}catch(B){console.warn("Error removing old destination marker:",B)}R.value=null}const k=e.map(B=>[B.lat,B.lng]),u=c||{public:"#4CAF50",private:"#FF6B6B",hybrid:"#2196F3",direct:"#9E9E9E"}[t]||"#9E9E9E";C.value=j.polyline(k,{color:u,weight:6,opacity:.8,smoothFactor:1}).addTo(r.value),We.value=!0;const h=P.calculateRouteDistance(e),n=h>1e3?`${(h/1e3).toFixed(2)} km`:`${Math.round(h)} m`,d=Lt(h),A={public:"üü¢ Public Roads",private:"üî¥ Campus Path",hybrid:"üîµ Public ‚Üí Campus",direct:"‚ö™ Direct Line"},D=Me.find(B=>B.value===H.value);z.value=`${A[t]}
${D.icon} ${D.label}
üìè ${n}
‚è±Ô∏è ${d.minutes} min
üïê Arrive at ${d.arrivalTime}`,$.value=Pt(e,i),N.value=!0,console.log(`Generated ${$.value.length} navigation instructions`);try{C.value&&r.value.hasLayer(C.value)&&r.value.fitBounds(C.value.getBounds(),{padding:[50,50]})}catch(B){console.warn("Error fitting bounds:",B)}m.success(`Route via ${A[t]}`)},$t=()=>{const e=localStorage,t=[],i=Date.now();for(let c=0;c<e.length;c++){const k=e.key(c);if(k&&k.startsWith("facility_notes_"))try{const a=e.getItem(k);if(a){const u=JSON.parse(a),h=u.filter(n=>!(n.expiresAt&&n.expiresAt<i));h.length!==u.length&&e.setItem(k,JSON.stringify(h)),t.push(...h)}}catch(a){console.warn(`Error parsing notes from ${k}:`,a)}}ee.value=t,console.log(`üìù Loaded ${t.length} notes from ${Oe}`)},At=()=>{if(!r.value){m.error("Map not initialized");return}if(!w.userLocation.value){m.error("GPS location not available yet");return}const{lat:e,lng:t}=w.userLocation.value;r.value.flyTo([e,t],18,{animate:!0,duration:1.5}),m.success("Centered on your location"),w.userMarker.value&&setTimeout(()=>{w.userMarker.value.openPopup(),setTimeout(()=>w.userMarker.value.closePopup(),2e3)},1500)},Qe=async e=>{try{const t=Oe==="localStorage"?localStorage:sessionStorage,i=ee.value.find(u=>u.id===e);if(!i)return;let c=!1;const k=re.value.find(u=>u.marker_id===i.marker_id);if(k){const u=`facility_notes_${k.id}`,h=t.getItem(u);if(h){let n=JSON.parse(h);const d=n.filter(A=>A.id!==e);d.length!==n.length&&(d.length===0?t.removeItem(u):t.setItem(u,JSON.stringify(d)),c=!0)}}if(!c)for(let u=0;u<t.length;u++){const h=t.key(u);if(!(!h||!h.startsWith("facility_notes_")))try{const n=t.getItem(h);if(!n)continue;let d=JSON.parse(n);const A=d.filter(D=>D.id!==e);if(A.length!==d.length){A.length===0?t.removeItem(h):t.setItem(h,JSON.stringify(A)),c=!0;break}}catch(n){console.warn("Error checking storage key for note deletion:",h,n)}}const a=ve.value.findIndex(u=>u.noteId===e);if(a!==-1&&r.value){const u=ve.value[a].marker;if(u)try{u.off(),r.value.hasLayer(u)&&r.value.removeLayer(u)}catch(h){console.warn("Error removing note marker:",h)}ve.value.splice(a,1)}ee.value=ee.value.filter(u=>u.id!==e),c?m.success("Note deleted"):m.warning("Note removed from view but not found in storage")}catch(t){console.error("Error deleting note:",t)}},Ft=async()=>{if(!ie.value.trim()){m.error("Please enter a note before saving");return}if(!p.value.id){m.error("Guest information not found");return}if(!l.value){m.error("Select a destination to attach the note");return}Je.value=!0;try{const e=Oe==="localStorage"?localStorage:sessionStorage,t=`facility_notes_${l.value.id}`,i=`${t}_expiration`,c=e.getItem(t);let k=c?JSON.parse(c):[];const a=Date.now();k=k.filter(d=>!(d.expiresAt&&d.expiresAt<a));const u=k.findIndex(d=>d.guest_id===p.value.id),h=a+1440*60*1e3,n={id:`${Oe}_${Date.now()}`,content:ie.value.trim(),marker_id:l.value.marker_id,guest_id:p.value.id,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),expiresAt:h,guest:{id:p.value.id,name:p.value.nickname}};u!==-1?k[u]=n:k.push(n),e.setItem(t,JSON.stringify(k)),ee.value=ee.value.filter(d=>!(d.marker_id===l.value.marker_id&&d.guest_id===p.value.id)),ee.value=[...ee.value,n],window.location.reload()}catch(e){console.error("Error saving note:",e),m.error("Failed to save note")}finally{Je.value=!1}},Tt=e=>{const t=e?.target?.files?.[0];t&&(me.value&&URL.revokeObjectURL(me.value),Ue.value=t,me.value=URL.createObjectURL(t),e?.target&&(e.target.value=""))},ze=()=>{me.value&&URL.revokeObjectURL(me.value),Ue.value=null,me.value=null,Ne.value="",$e.value&&($e.value.value="")},Dt=()=>{const e=De.value.find(t=>t.guest_id===p.value.id);e?ie.value=e.content:ie.value="",Ce.value=!0},Rt=async()=>{if(!l.value){m.error("Select a destination before uploading photos");return}if(!p.value.id){m.error("Guest information not found");return}if(!Ue.value){m.error("Choose a photo to upload");return}Ve.value=!0;try{const e=new FormData;e.append("photo",Ue.value),e.append("guest_id",p.value.id),Ne.value.trim()&&e.append("caption",Ne.value.trim());const t=await pe.post(`/pub/facilities/${l.value.id}/photos`,e,{headers:{"Content-Type":"multipart/form-data"}}),i=t.data.photo,c=l.value.id;ae.value={...ae.value,[c]:[i,...ae.value[c]||[]]},m.success(t.data.message||"Photo uploaded successfully!"),ze()}catch(e){console.error("Error uploading photo:",e),m.error("Failed to upload photo")}finally{Ve.value=!1}},zt=()=>{$e.value&&$e.value.click()},Ge=e=>{if(!e)return"";try{return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return console.warn("Failed to format timestamp:",t),e}},et=()=>{if(!r.value||!r.value._loaded||!Array.isArray(W.value)){console.warn("displayNotesOnMap: Map or markers not ready");return}if(!p.value||!p.value.id){console.warn("displayNotesOnMap: Guest info not available");return}if(he||r.value._animatingZoom||r.value._isZooming){console.warn("displayNotesOnMap: BLOCKED - Zoom in progress!");return}if(r.value._zoom!==r.value.getZoom()){console.warn("displayNotesOnMap: Zoom level mismatch, delaying..."),setTimeout(()=>et(),300);return}ve.value.forEach(e=>{if(e.marker&&r.value)try{e.marker.off(),r.value.hasLayer(e.marker)&&r.value.removeLayer(e.marker)}catch(t){console.warn("Error removing note marker:",t)}}),ve.value=[],W.value.forEach((e,t)=>{const i=re.value[t];if(!i)return;const c=ee.value.find(k=>k.marker_id===i.marker_id&&k.guest_id===p.value.id);if(c)try{const k=n=>{const d=document.createElement("div");return d.textContent=n,d.innerHTML},a=`
          <div class="note-bubble-container" data-note-id="${c.id}" style="
            background: white !important;
            border: 2px solid #E5E7EB !important;
            border-radius: 12px !important;
            padding: 14px 16px !important;
            min-width: 220px !important;
            max-width: 300px !important;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15), 0 4px 10px rgba(0, 0, 0, 0.08) !important;
            position: relative !important;
            opacity: 1 !important;
            transform: translateY(-100%) !important;
            margin-bottom: 20px !important;
            pointer-events: auto !important;
          ">
            <div class="note-bubble-header" style="
              display: flex !important;
              align-items: flex-start !important;
              gap: 10px !important;
              margin-bottom: 10px !important;
              padding-bottom: 10px !important;
              border-bottom: 1px solid #F3F4F6 !important;
            ">
              <div class="note-bubble-icon" style="font-size: 20px !important; line-height: 1 !important; flex-shrink: 0 !important;">üí¨</div>
              <div class="note-bubble-meta" style="
                flex: 1 !important;
                display: flex !important;
                flex-direction: column !important;
                gap: 3px !important;
              ">
                <span class="note-bubble-label" style="
                  font-size: 11px !important;
                  font-weight: 700 !important;
                  color: #6366F1 !important;
                  text-transform: uppercase !important;
                  letter-spacing: 0.8px !important;
                ">Your Note</span>
                <span class="note-bubble-time" style="
                  font-size: 10px !important;
                  color: #9CA3AF !important;
                  font-weight: 500 !important;
                ">${Ge(c.created_at)}</span>
              </div>
              <button
                class="note-bubble-delete"
                title="Delete note"
                data-note-id="${c.id}"
                style="
                  background: #FEE2E2 !important;
                  border: none !important;
                  border-radius: 6px !important;
                  width: 24px !important;
                  height: 24px !important;
                  display: flex !important;
                  align-items: center !important;
                  justify-content: center !important;
                  cursor: pointer !important;
                  color: #EF4444 !important;
                  transition: all 0.2s ease !important;
                  flex-shrink: 0 !important;
                  padding: 0 !important;
                "
              >
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                  <path d="M9 3L3 9M3 3L9 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
              </button>
            </div>
            <div class="note-bubble-content" style="
              font-size: 14px !important;
              color: #1F2937 !important;
              line-height: 1.6 !important;
              word-wrap: break-word !important;
              font-weight: 400 !important;
              padding: 0 !important;
            ">${k(c.content)}</div>
            <div class="note-bubble-arrow" style="
              position: absolute !important;
              bottom: -10px !important;
              left: 50% !important;
              transform: translateX(-50%) !important;
              width: 0 !important;
              height: 0 !important;
              border-left: 12px solid transparent !important;
              border-right: 12px solid transparent !important;
              border-top: 12px solid white !important;
              filter: drop-shadow(0 3px 3px rgba(0, 0, 0, 0.1)) !important;
            "></div>
          </div>
        `,u=j.divIcon({className:"note-bubble-marker",html:a,iconSize:[280,"auto"],iconAnchor:[140,70]});if(!r.value||he||r.value._animatingZoom){console.warn(`Aborting note marker creation for ${i.name} - zoom in progress`);return}const h=j.marker([i.lat,i.lng],{icon:u,interactive:!0,zIndexOffset:1e3,bubblingMouseEvents:!0});try{h.addTo(r.value)}catch(n){console.error("Failed to add note marker to map:",n);return}ve.value.push({noteId:c.id,marker:h,facilityMarkerId:i.marker_id}),setTimeout(()=>{const n=document.querySelector(`.note-bubble-delete[data-note-id="${c.id}"]`);n&&n.addEventListener("click",d=>{d.stopPropagation(),Qe(c.id)})},150)}catch(k){console.error(`‚ùå Error creating note marker for ${i.name}:`,k)}}),console.log(`üìù Created ${ve.value.length} note bubble markers`)};let tt=null,he=!1;const ot=()=>{if(he){console.warn("debouncedDisplayNotes: Skipping due to zoom in progress");return}tt&&clearTimeout(tt),tt=setTimeout(()=>{!he&&r.value&&!r.value._animatingZoom&&et()},250)};Ie(ee,()=>{r.value&&!he&&ot()},{deep:!0}),Ie(()=>F.polygons,()=>{r.value&&Q(F.polygons,r.value)},{deep:!0,immediate:!1});const ut=async()=>{try{const e=await pe.get("/routes/export/geojson-pub",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});s.value=e.data,r.value&&Gt(),console.log("Loaded routes from database:",s.value)}catch(e){console.error("Error loading routes from database:",e),m.error("Failed to load campus paths")}},Gt=()=>{if(!r.value||!s.value||!s.value.features){console.warn("Cannot refresh private routes: Map or data not ready");return}T.value.forEach(e=>{if(r.value&&r.value.hasLayer&&r.value.hasLayer(e))try{r.value.removeLayer(e)}catch(t){console.warn("Error removing route layer:",t)}}),T.value=[],s.value.features.forEach(e=>{if(e.geometry&&e.geometry.type==="LineString"){const t=e.properties?.color||"#FF6B6B",i=j.geoJSON(e,{style:{color:t,weight:6,opacity:.9,dashArray:"10, 5",lineCap:"round",lineJoin:"round"}}).addTo(r.value);i.on("click",c=>{j.DomEvent.stopPropagation(c),we(c.latlng,null,e.properties?.color)}),T.value.push(i)}}),console.log(`Added ${s.value.features.length} campus path layers`)},dt=async()=>{try{const e=await pe.get("/",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(e.data&&e.data.props&&e.data.props.facilities){if(J.facilities=e.data.props.facilities,W.value.forEach(t=>{if(r.value&&r.value.hasLayer&&r.value.hasLayer(t))try{r.value.removeLayer(t)}catch(i){console.warn("Error removing marker:",i)}}),W.value=[],re.value.length>0)for(let t=0;t<re.value.length;t++){const i=re.value[t],c=K(i,r.value);if(c){typeof c.unbindPopup=="function"&&c.unbindPopup();let k=i.marker?.label||i.department||"Loading location...",a=`
              <div style="padding: 8px; min-width: 200px;">
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                  <span style="font-size: 20px;">${i.icon}</span>
                  <strong style="font-size: 14px; color: #1f2937;">${i.name}</strong>
                </div>
                <p style="font-size: 12px; color: #6b7280; margin: 0;">${k}</p>
                <button
                  onclick="window.dispatchEvent(new CustomEvent('open-facility-panel', { detail: ${i.id} }))"
                  style="margin-top: 8px; width: 100%; background: #3b82f6; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;"
                  onmouseover="this.style.background='#2563eb'"
                  onmouseout="this.style.background='#3b82f6'"
                >
                  View Details
                </button>
              </div>
            `;c.bindPopup(a,{closeButton:!1,className:"facility-popup",offset:[0,-15]}),setTimeout(()=>{console.log(`Geocoding ${i.name} at [${i.lat}, ${i.lng}]`),pt(i.lat,i.lng).then(u=>{u?(k=u,a=`
                      <div style="padding: 8px; min-width: 200px;">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                          <span style="font-size: 20px;">${i.icon}</span>
                          <strong style="font-size: 14px; color: #1f2937;">${i.name}</strong>
                        </div>
                        <p style="font-size: 12px; color: #6b7280; margin: 0;">${k}</p>
                        <button
                          onclick="window.dispatchEvent(new CustomEvent('open-facility-panel', { detail: ${i.id} }))"
                          style="margin-top: 8px; width: 100%; background: #3b82f6; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;"
                          onmouseover="this.style.background='#2563eb'"
                          onmouseout="this.style.background='#3b82f6'"
                        >
                          View Details
                        </button>
                      </div>
                    `,c.setPopupContent(a)):console.warn(`No geocoded address for ${i.name}, keeping fallback`)}).catch(u=>{console.error(`Geocoding failed for ${i.name}:`,u)})},t*1e3),c.on("mouseover",function(){this.openPopup()}),c.on("popupopen",function(){const h=this.getPopup().getElement();h&&(h.addEventListener("mouseenter",()=>{c.openPopup()}),h.addEventListener("mouseleave",()=>{c.closePopup()}))}),c.on("mouseout",function(){const u=this;setTimeout(()=>{const h=u.getPopup();h&&h.getElement()&&(h.getElement().matches(":hover")||u.closePopup())},100)}),c.on("click",()=>{Re(i)})}}console.log("‚úì Facilities loaded and markers refreshed:",re.value.length)}}catch(e){console.error("Error loading facilities:",e),m.error("Failed to load facilities")}},jt=async()=>{try{const e=await pe.get("/facilities/polygons",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});e.data&&(U.value.forEach(t=>{if(r.value&&r.value.hasLayer&&r.value.hasLayer(t))try{r.value.removeLayer(t)}catch(i){console.warn("Error removing polygon:",i)}}),U.value=[],Q(e.data,r.value),console.log("‚úì Polygons loaded and refreshed"))}catch(e){console.error("Error loading polygons:",e),m.error("Failed to load polygons")}},at=e=>{if(l.value&&We.value)if(le.value){const t=P.calculateDistance(le.value.lat,le.value.lng,e.lat,e.lng);t>10?(console.log(`User moved ${Math.round(t)}m since last route calculation, updating route...`),le.value={lat:e.lat,lng:e.lng},m.info("Updating route from new position...",{timeout:2e3}),we(j.latLng(l.value.lat,l.value.lng),l.value)):console.log(`User moved ${Math.round(t)}m (< 10m threshold, keeping current route)`)}else C.value&&(console.log("Initial GPS sync for existing route, recalculating..."),le.value={lat:e.lat,lng:e.lng},we(j.latLng(l.value.lat,l.value.lng),l.value))},pt=async(e,t)=>{try{const i=await pe.get("/api/geocode/reverse",{params:{lat:e,lng:t}});return i.data&&i.data.success?i.data.address:(console.warn("No address data in response"),null)}catch(i){return console.error("Reverse geocoding error:",i),null}},gt=async()=>{try{await ut(),$t();const e=j.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"&copy; OpenStreetMap contributors"}),t=j.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{maxZoom:19,attribution:"Tiles ¬© Esri ‚Äî Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"});r.value=j.map("map",{center:[8.1695,126.001838],zoom:17,layers:[e],zoomControl:!0}),Fe.value="navigation";const i={navigation:{layer:e},satellite:{layer:t}},c=a=>{if(!i[a]||Fe.value===a)return;const u=i[Fe.value]?.layer;u&&r.value.hasLayer(u)&&r.value.removeLayer(u),i[a].layer.addTo(r.value),Fe.value=a},k=j.Control.extend({options:{position:"bottomright"},onAdd:()=>{const a=j.DomUtil.create("div","leaflet-control guest-map-controls");a.innerHTML=`
          <button type="button" class="guest-control-button guest-control-button__locate" data-action="locate" title="Jump to my location">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="3" />
              <path d="M12 5V3" />
              <path d="M12 21v-2" />
              <path d="M5 12H3" />
              <path d="M21 12h-2" />
              <path d="M19.071 4.929l-1.414 1.414" />
              <path d="M6.343 17.657l-1.414 1.414" />
              <path d="M4.929 4.929l1.414 1.414" />
              <path d="M17.657 17.657l1.414 1.414" />
            </svg>
          </button>
          <div class="guest-base-toggle">
            <button type="button" class="guest-control-button" data-layer="navigation" title="Navigation view">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 20l-6-2V6l6 2 6-2 6 2v12l-6-2-6 2z" />
                <path d="M9 8v12" />
                <path d="M15 6v12" />
              </svg>
            </button>
            <button type="button" class="guest-control-button" data-layer="satellite" title="Satellite view">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                <path d="M4 4h6l10 10-6 6L4 10V4z" />
                <path d="M2 12l4-4" />
                <path d="M12 22l4-4" />
                <path d="M14 10l-4 4" />
              </svg>
            </button>
          </div>
        `;const u=a.querySelector('[data-action="locate"]'),h=a.querySelectorAll("[data-layer]"),n=()=>{h.forEach(d=>{d.classList.toggle("is-active",d.dataset.layer===Fe.value)})};return j.DomEvent.on(u,"click",d=>{j.DomEvent.stopPropagation(d),j.DomEvent.preventDefault(d),At()}),h.forEach(d=>{j.DomEvent.on(d,"click",A=>{j.DomEvent.stopPropagation(A),j.DomEvent.preventDefault(A);const D=d.dataset.layer;c(D),n()})}),n(),j.DomEvent.disableClickPropagation(a),j.DomEvent.disableScrollPropagation(a),a}});r.value.addControl(new k),r.value.whenReady(()=>{if(re.value.length>0){console.log(`Adding ${re.value.length} facility markers`);for(let h=0;h<re.value.length;h++){const n=re.value[h],d=K(n,r.value);if(d){typeof d.unbindPopup=="function"&&d.unbindPopup();let A=n.marker?.label||n.department||"Loading location...",D=`
              <div style="padding: 8px; min-width: 200px;">
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                  <span style="font-size: 20px;">${n.icon}</span>
                  <strong style="font-size: 14px; color: #1f2937;">${n.name}</strong>
                </div>
                <p style="font-size: 12px; color: #6b7280; margin: 0;">${A}</p>
                <button
                  onclick="window.dispatchEvent(new CustomEvent('open-facility-panel', { detail: ${n.id} }))"
                  style="margin-top: 8px; width: 100%; background: #3b82f6; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;"
                  onmouseover="this.style.background='#2563eb'"
                  onmouseout="this.style.background='#3b82f6'"
                >
                  View Details
                </button>
              </div>
            `;d.bindPopup(D,{closeButton:!1,className:"facility-popup",offset:[0,-15]}),setTimeout(()=>{pt(n.lat,n.lng).then(B=>{B&&(A=B,D=`
                      <div style="padding: 8px; min-width: 200px;">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                          <span style="font-size: 20px;">${n.icon}</span>
                          <strong style="font-size: 14px; color: #1f2937;">${n.name}</strong>
                        </div>
                        <p style="font-size: 12px; color: #6b7280; margin: 0;">${A}</p>
                        <button
                          onclick="window.dispatchEvent(new CustomEvent('open-facility-panel', { detail: ${n.id} }))"
                          style="margin-top: 8px; width: 100%; background: #3b82f6; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;"
                          onmouseover="this.style.background='#2563eb'"
                          onmouseout="this.style.background='#3b82f6'"
                        >
                          View Details
                        </button>
                      </div>
                    `,d.setPopupContent(D))}).catch(B=>{console.error(`Geocoding failed for ${n.name}:`,B)})},h*1e3),d.on("mouseover",function(){this.openPopup()}),d.on("popupopen",function(){const Y=this.getPopup().getElement();Y&&(Y.addEventListener("mouseenter",()=>{d.openPopup()}),Y.addEventListener("mouseleave",()=>{d.closePopup()}))}),d.on("mouseout",function(){const B=this;setTimeout(()=>{const Y=B.getPopup();Y&&Y.getElement()&&(Y.getElement().matches(":hover")||B.closePopup())},100)}),d.on("click",()=>{Re(n)})}}}setTimeout(()=>{et()},300),F.polygons&&F.polygons.length>0&&Q(F.polygons,r.value),s.value&&s.value.features&&s.value.features.forEach(h=>{if(h.geometry&&h.geometry.type==="LineString"){const n=h.properties?.color||"#FF6B6B",d=j.geoJSON(h,{style:{color:n,weight:6,opacity:.9,dashArray:"10, 5",lineCap:"round",lineJoin:"round"}}).addTo(r.value);d.on("click",A=>{j.DomEvent.stopPropagation(A),we(A.latlng,null,h.properties?.color)}),T.value.push(d)}}),r.value.on("click",h=>{we(h.latlng)});let a=!1;r.value.on("zoomstart",()=>{he=!0,r.value._isZooming=!0}),r.value.on("zoomend",()=>{setTimeout(()=>{he=!1,r.value._isZooming=!1,a&&(a=!1,ot())},100)});const u=ot;window.addEventListener("notesPending",()=>{he&&(a=!0)}),setTimeout(()=>{w.startTracking(p.value,r.value,at)},500)})}catch(e){console.error("Error initializing map:",e),m.error("Failed to initialize map. Please refresh the page.")}},Bt=e=>{Re(e),M.value=e.name,Z.value=!1,we(j.latLng(e.lat,e.lng),e),console.log(`Routing to ${e.name}`)},vt=()=>{if(M.value="",l.value=null,f.value=null,Z.value=!1,le.value=null,We.value=!1,fe.value=!1,ie.value="",Ce.value=!1,_.value="",ze(),C.value&&r.value){try{r.value.hasLayer(C.value)&&r.value.removeLayer(C.value)}catch(e){console.warn("Error removing route polyline:",e)}C.value=null}if(R.value&&r.value){try{r.value.hasLayer(R.value)&&r.value.removeLayer(R.value)}catch(e){console.warn("Error removing destination marker:",e)}R.value=null}z.value=null,N.value=!1,console.log("Route cleared")},Ot=async()=>{if(!_.value.trim()){m.error("Please enter your feedback");return}if(!p.value.id){m.error("Guest information not found");return}if(!l.value){m.error("Select a destination before sending feedback");return}q.value=!0;try{const e=await pe.post("/create/feedback",{guest_id:p.value.id,marker_id:l.value.marker_id,message:_.value.trim()}),t={...e.data.feedback,message:_.value.trim(),marker_id:l.value.marker_id,guest:{id:p.value.id,name:p.value.nickname}};be.value=[...be.value,t],E.value=e.data.message,m.success(E.value||"Feedback saved successfully!"),_.value=""}catch(e){console.error("Error saving feedback:",e),m.error("Failed to save feedback")}finally{q.value=!1}},Ut=e=>{X.value=e,Ye.value=!0},ft=()=>{Ye.value=!1},Vt=()=>{X.value<qe.value.length-1&&X.value++},Jt=()=>{X.value>0&&X.value--},Ht=Mt();return Wt(()=>{Ht&&(gt(),console.log(`Welcome back, ${p.value.nickname}!`)),window.addEventListener("open-facility-panel",e=>{const t=e.detail,i=re.value.find(c=>c.id===t);i&&Re(i)}),window.addEventListener("delete-note",e=>{const t=e.detail;confirm("Are you sure you want to delete this note?")&&Qe(t)}),window.Echo.channel("main-channel").listen(".MainEvent",e=>{if(e.type==="route"&&(ut(),console.log("Route event:",e.action)),e.type==="facility"&&(dt(),console.log("Facility event:",e.action)),e.type==="marker"&&(dt(),console.log("Marker event:",e.action)),e.type==="polygon"&&(jt(),console.log("Polygon event:",e.action)),e.type==="photo"&&e.action==="create"&&e.data){const t=e.data?.facility_id;if(t){const i=ae.value[t]||[];i.some(k=>k.id===e.data.id)||(ae.value={...ae.value,[t]:[e.data,...i]})}}e.type==="feedback"&&e.action==="create"&&e.data&&(be.value.some(i=>i.id===e.data.id)||(be.value=[...be.value,e.data]))})}),Yt(()=>{if(w.stopTracking(r.value),ne.value&&clearInterval(ne.value),ze(),r.value)try{C.value&&r.value.hasLayer(C.value)&&r.value.removeLayer(C.value),R.value&&r.value.hasLayer(R.value)&&r.value.removeLayer(R.value),T.value.forEach(e=>{r.value.hasLayer(e)&&r.value.removeLayer(e)}),ve.value.forEach(e=>{e.marker&&r.value.hasLayer(e.marker)&&r.value.removeLayer(e.marker)})}catch(e){console.warn("Error during cleanup:",e)}console.log("Component unmounted, cleanup complete")}),(e,t)=>{const i=rt("MapPinIcon"),c=rt("Square3Stack3DIcon"),k=rt("ClockIcon");return v(),g("div",io,[oe(Xt,{name:"details-panel"},{default:qt(()=>[x(I)&&fe.value&&x(l)?(v(),g("aside",co,[t[24]||(t[24]=o("div",{class:"md:hidden flex justify-center pt-2 pb-1"},[o("div",{class:"w-12 h-1 bg-gray-300 rounded-full"})],-1)),o("div",uo,[t[14]||(t[14]=o("div",{class:"absolute top-0 left-0 right-0 h-1 bg-green-900/10"},null,-1)),o("div",po,[o("div",go,[o("div",vo,[o("div",fo,[o("div",mo,y(x(l).icon),1),o("div",ho,[o("h2",yo,y(x(l).name),1),o("div",xo,[o("span",bo,y(x(l).category),1),x(l).department?(v(),g("span",wo,y(x(l).department),1)):L("",!0)])])]),o("div",ko,[x(l).marker?.label?(v(),g("div",_o,[oe(i,{class:"w-3.5 h-3.5 text-gray-400 flex-shrink-0"}),o("span",So,y(x(l).marker.label),1)])):L("",!0),x(l).marker?.floor||x(l).floor_number?(v(),g("div",Mo,[oe(c,{class:"w-3.5 h-3.5 text-gray-400 flex-shrink-0"}),o("span",Co," Floor "+y(x(l).marker?.floor||x(l).floor_number),1)])):L("",!0),x(l).hours?(v(),g("div",Eo,[oe(k,{class:"w-3.5 h-3.5 text-green-600 flex-shrink-0 mt-0.5"}),o("span",Lo,y(x(l).hours),1)])):L("",!0)])]),o("button",{onClick:It,class:"flex-shrink-0 -mt-1 -mr-1 p-1.5 text-gray-400 hover:bg-gray-100 hover:text-gray-600 rounded-lg transition-colors"},[oe(x(Ke),{class:"h-5 w-5"})])])])]),o("div",Po,[o("section",Io,[x(l).description?(v(),g("p",No,y(x(l).description),1)):L("",!0),o("div",$o,[o("button",{type:"button",onClick:Nt,class:"inline-flex flex-1 items-center justify-center gap-2 rounded-lg bg-green-900 px-3 py-2 text-sm font-semibold text-white transition hover:bg-green-800"},[oe(x(ro),{class:"h-5 w-5"}),t[15]||(t[15]=Ze(" Start Navigation ",-1))]),x(C)?(v(),g("button",{key:0,type:"button",onClick:vt,class:"inline-flex items-center justify-center gap-2 rounded-lg border border-gray-300 px-3 py-2 text-sm font-semibold text-gray-700 transition hover:bg-gray-100"}," ‚úñ Clear ")):L("",!0)]),x(z)?(v(),g("div",Ao,[t[16]||(t[16]=o("div",{class:"border-b border-gray-200 bg-gray-100 px-3 py-2"},[o("h3",{class:"text-xs font-semibold text-gray-800"},"Route Info")],-1)),o("p",Fo,y(x(z)),1)])):L("",!0),x(N)&&x($).length?(v(),g("div",To,[t[17]||(t[17]=o("div",{class:"border-b border-gray-200 bg-gray-100 px-3 py-2"},[o("h3",{class:"text-xs font-semibold text-gray-800"},"Navigation Steps")],-1)),o("div",{class:"max-h-60 overflow-y-auto",ref_key:"navigationInstructionsContainer",ref:ge},[(v(!0),g(ye,null,xe(x($),(a,u)=>(v(),g("div",{key:u,class:"flex gap-3 px-3 py-3 border-b border-gray-100 last:border-b-0 hover:bg-gray-50"},[o("span",Do,y(a.icon),1),o("div",Ro,[o("p",zo,y(a.text),1),o("p",Go,y(a.distance),1)])]))),128))],512)])):L("",!0)]),o("section",jo,[o("div",Bo,[t[18]||(t[18]=o("h3",{class:"text-sm font-semibold text-gray-800"},"Photos",-1)),o("span",Oo,y(Pe.value.total)+" total",1)]),o("div",Uo,[o("div",Vo,[o("input",{ref_key:"photoInput",ref:$e,type:"file",accept:"image/*",class:"hidden",onChange:Tt},null,544),me.value?(v(),g("div",Ho,[o("img",{src:me.value,alt:"Photo preview",class:"mx-auto max-h-40 rounded-md object-cover shadow-sm"},null,8,Zo),je(o("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>Ne.value=a),type:"text",maxlength:"255",placeholder:"Add a short caption (optional)",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-gray-400 focus:outline-none focus:ring-1 focus:ring-gray-400 bg-white"},null,512),[[Be,Ne.value]]),o("div",Ko,[o("button",{type:"button",class:"rounded-md border border-gray-300 px-3 py-2 text-xs font-medium text-gray-700 hover:bg-gray-50 transition",onClick:ze}," Cancel "),o("button",{type:"button",class:"rounded-md bg-green-900 px-3 py-2 text-xs font-semibold text-white hover:bg-green-800 transition",disabled:Ve.value,onClick:Rt},y(Ve.value?"Uploading...":"Save Photo"),9,Wo)])])):(v(),g("div",Jo,[t[19]||(t[19]=o("p",{class:"text-sm text-gray-600"},"üì∏ Click to upload a photo",-1)),o("button",{type:"button",class:"inline-flex items-center justify-center rounded-md bg-green-900 px-3 py-2 text-xs font-semibold text-white transition hover:bg-green-800",onClick:zt}," Choose Photo ")]))]),Pe.value.total>0?(v(),g("div",Yo,[o("div",qo,[(v(!0),g(ye,null,xe(qe.value,(a,u)=>(v(),g("article",{key:a.id,onClick:h=>Ut(u),class:"overflow-hidden rounded-lg border border-gray-200 bg-white shadow-sm cursor-pointer transition hover:shadow-md hover:border-gray-300"},[o("img",{src:a.url,alt:a.caption||x(l).name,class:"h-28 w-full object-cover"},null,8,Qo),o("div",ea,[o("p",ta,y(a.caption||"Shared photo"),1),o("p",oa,y(a.guest?.name||"Guest")+" ‚Ä¢ "+y(Ge(a.created_at)),1)])],8,Xo))),128))]),Pe.value.total>2&&!Ee.value?(v(),g("button",{key:0,onClick:t[1]||(t[1]=a=>Ee.value=!0),class:"w-full rounded-lg border border-gray-300 bg-gray-50 px-4 py-2.5 text-sm font-medium text-gray-700 transition hover:bg-gray-100 hover:border-gray-400"}," + "+y(Pe.value.total-2)+" More Photo"+y(Pe.value.total-2>1?"s":""),1)):L("",!0),Ee.value&&Pe.value.total>2?(v(),g("button",{key:1,onClick:t[2]||(t[2]=a=>Ee.value=!1),class:"w-full rounded-lg border border-gray-300 bg-gray-50 px-4 py-2.5 text-sm font-medium text-gray-700 transition hover:bg-gray-100 hover:border-gray-400"}," Show Less ")):L("",!0)])):(v(),g("p",aa,"Be the first to share a photo for this place."))])]),o("section",ra,[o("div",sa,[t[20]||(t[20]=o("h3",{class:"text-sm font-semibold text-gray-800"},"Notes",-1)),o("span",na,y(De.value.length)+" total",1)]),o("div",la,[o("p",null,"You can add one note that will appear on the map. It expires after 24 hours and is stored in your browser ("+y(Oe==="localStorage"?"persists across sessions":"session only")+").",1),t[21]||(t[21]=o("p",{class:"font-semibold text-green-700"},"Notes appear as purple bubbles above markers. Click the ‚úï button to delete!",-1))]),Ce.value?(v(),g("div",ia,[je(o("textarea",{"onUpdate:modelValue":t[3]||(t[3]=a=>ie.value=a),rows:"3",maxlength:"500",placeholder:"Share a quick note or tip about this spot...",class:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-gray-400 focus:outline-none focus:ring-1 focus:ring-gray-400 bg-white",autofocus:"",onKeydown:t[4]||(t[4]=mt(de(()=>{},["prevent"]),["enter"]))},null,544),[[Be,ie.value]]),o("div",ca,[o("button",{type:"button",class:"rounded-md border border-gray-300 px-3 py-2 text-xs font-medium text-gray-700 hover:bg-gray-100 transition",onClick:t[5]||(t[5]=de(a=>Ce.value=!1,["prevent"]))}," Cancel "),o("button",{type:"button",class:"rounded-md bg-green-900 px-3 py-2 text-xs font-semibold text-white hover:bg-green-800 transition",disabled:Je.value||!ie.value.trim(),onClick:de(Ft,["prevent"])},y(Je.value?"Saving...":"Save Note"),9,ua)])])):L("",!0),Ce.value?L("",!0):(v(),g("div",da,[o("button",{type:"button",class:"w-full rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 px-4 py-2.5 text-sm font-medium text-gray-700 transition hover:border-gray-400 hover:bg-gray-100",onClick:de(Dt,["prevent"])},y(_t.value?"‚úèÔ∏è Edit Your Note":"+ Add Note"),1)])),De.value.length?(v(),g("div",pa,[(v(!0),g(ye,null,xe(De.value,a=>(v(),g("article",{key:a.id,class:Se(["rounded-lg p-3 shadow-sm transition",a.guest_id===p.value.id?"ml-8 bg-green-100 border-l-4 border-green-700":"mr-8 bg-gray-100 border-l-4 border-gray-400"])},[o("div",ga,[o("div",null,[o("p",va,[Ze(y(a.guest?.name||"Guest")+" ",1),a.guest_id===p.value.id?(v(),g("span",fa," (You)")):L("",!0)]),o("p",ma,y(Ge(a.created_at)),1)]),a.guest_id===p.value.id?(v(),g("button",{key:0,type:"button",class:"rounded-md p-1 text-gray-400 transition hover:bg-gray-200 hover:text-red-500",onClick:de(u=>Qe(a.id),["prevent"]),title:"Delete note"},[oe(x(Ke),{class:"h-4 w-4"})],8,ha)):L("",!0)]),o("p",ya,y(a.content),1)],2))),128))])):(v(),g("p",xa,"No notes yet. Be the first to share!"))]),o("section",ba,[o("div",wa,[t[22]||(t[22]=o("h3",{class:"text-sm font-semibold text-gray-800"},"Feedback",-1)),o("span",ka,y(Xe.value.length)+" total",1)]),Ae.value?(v(),g("div",_a,[je(o("textarea",{"onUpdate:modelValue":t[6]||(t[6]=a=>ht(_)?_.value=a:null),rows:"3",maxlength:"500",placeholder:"How was your experience here?",class:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-gray-400 focus:outline-none focus:ring-1 focus:ring-gray-400 bg-white",autofocus:""},null,512),[[Be,x(_)]]),o("div",Sa,[o("button",{type:"button",class:"rounded-md border border-gray-300 px-3 py-2 text-xs font-medium text-gray-700 hover:bg-gray-100 transition",onClick:t[7]||(t[7]=de(a=>Ae.value=!1,["prevent"]))}," Cancel "),o("button",{type:"button",class:"rounded-md bg-green-900 px-3 py-2 text-xs font-semibold text-white hover:bg-green-800 transition",disabled:x(q)||!x(_).trim(),onClick:de(Ot,["prevent"])},y(x(q)?"Sending...":"Submit Feedback"),9,Ma)])])):L("",!0),Ae.value?L("",!0):(v(),g("div",Ca,[o("button",{type:"button",class:"w-full rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 px-4 py-2.5 text-sm font-medium text-gray-700 transition hover:border-gray-400 hover:bg-gray-100",onClick:t[8]||(t[8]=de(a=>Ae.value=!Ae.value,["prevent"]))}," + Add Feedback ")])),Xe.value.length?(v(),g("div",Ea,[t[23]||(t[23]=o("h4",{class:"text-xs font-semibold text-gray-600 uppercase tracking-wide"},"Recent Feedback",-1)),o("div",La,[(v(!0),g(ye,null,xe(Xe.value,a=>(v(),g("article",{key:a.id,class:"rounded-lg border border-gray-200 bg-gray-50 px-3 py-3 shadow-sm"},[o("div",Pa,[o("p",Ia,y(a.guest?.name||"Guest"),1),o("p",Na,y(Ge(a.created_at)),1)]),o("p",$a,y(a.message),1)]))),128))])])):(v(),g("p",Aa,"No feedback yet. Share your thoughts!"))])])])):L("",!0)]),_:1}),o("div",Fa,[o("div",{id:"map",class:Se(["h-full w-full transition-all duration-300",x(I)?"":"blur-sm pointer-events-none"])},null,2),x(I)?(v(),g("div",Ta,[o("div",Da,[o("div",Ra,[o("div",za,[oe(x(yt),{class:"h-4 w-4 text-gray-400"})]),je(o("input",{"onUpdate:modelValue":t[9]||(t[9]=a=>ht(M)?M.value=a:null),type:"text",placeholder:"Search facilities by name, category, or floor...",class:"w-full border-0 py-3 pl-10 pr-10 text-sm text-gray-900 placeholder:text-gray-400 focus:ring-0 focus:outline-none bg-gray-50"},null,512),[[Be,x(M)]]),x(M)?(v(),g("button",{key:0,onClick:vt,class:"absolute inset-y-0 right-0 flex items-center pr-3.5 transition-colors","aria-label":"Clear search"},[oe(x(Ke),{class:"h-4 w-4 text-gray-400 hover:text-gray-600"})])):L("",!0)]),x(Z)?(v(),g("div",Ga,[x(te)?(v(),g("div",ja,[...t[25]||(t[25]=[o("div",{class:"inline-block h-5 w-5 animate-spin rounded-full border-2 border-gray-200 border-t-gray-600"},null,-1),o("p",{class:"mt-2.5 text-xs text-gray-500 font-medium"},"Searching facilities...",-1)])])):x(S).length===0?(v(),g("div",Ba,[o("div",Oa,[oe(x(yt),{class:"h-5 w-5 text-gray-400"})]),t[26]||(t[26]=o("p",{class:"mt-3 text-xs font-semibold text-gray-900"},"No results found",-1)),t[27]||(t[27]=o("p",{class:"mt-1 text-xs text-gray-500"},"Try adjusting your search criteria",-1))])):(v(),g("div",Ua,[o("div",Va,[o("p",Ja,y(x(S).length)+" "+y(x(S).length===1?"Facility":"Facilities")+" Found ",1)]),o("div",Ha,[(v(!0),g(ye,null,xe(x(S),a=>(v(),g("button",{key:a.id,onClick:u=>Bt(a),class:"flex w-full items-start gap-3 px-4 py-3 text-left transition-all hover:bg-gray-50 group"},[o("div",Ka,[o("span",Wa,y(a.icon),1)]),o("div",Ya,[o("div",qa,[o("h3",Xa,y(a.name),1),o("span",Qa," Floor "+y(a.floor_number),1)]),o("div",er,[o("span",tr,y(a.markerType),1),o("span",or,y(a.category),1)]),a.description?(v(),g("p",ar,y(a.description),1)):L("",!0),a.capacity||a.amenities||a.status||a.hours?(v(),g("div",rr,[a.capacity?(v(),g("div",sr,[t[29]||(t[29]=o("svg",{class:"w-3 h-3 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),o("span",nr,[o("span",lr,y(a.capacity),1),t[28]||(t[28]=Ze(" capacity ",-1))])])):L("",!0),a.amenities?(v(),g("div",ir,[t[31]||(t[31]=o("svg",{class:"w-3 h-3 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),o("span",cr,[o("span",ur,y(a.amenities.length),1),t[30]||(t[30]=Ze(" amenities ",-1))])])):L("",!0),a.status?(v(),g("div",dr,[o("span",{class:Se(["w-2 h-2 rounded-full flex-shrink-0",a.status==="available"?"bg-green-500":a.status==="occupied"?"bg-red-500":"bg-gray-400"])},null,2),o("span",pr,y(a.status),1)])):L("",!0),a.hours?(v(),g("div",gr,[t[32]||(t[32]=o("svg",{class:"w-3 h-3 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),o("span",vr,y(a.hours),1)])):L("",!0)])):L("",!0)]),t[33]||(t[33]=o("div",{class:"flex-shrink-0 mt-1.5"},[o("svg",{class:"w-4 h-4 text-gray-300 group-hover:text-green-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})])],-1))],8,Za))),128))])]))])):L("",!0)])])):L("",!0),x(I)?(v(),g("div",fr,[o("div",mr,[(v(),g(ye,null,xe(Me,a=>o("button",{key:a.value,onClick:u=>H.value=a.value,class:Se(["min-w-[44px] rounded-md px-2.5 py-2 text-xs font-medium transition sm:px-3 sm:text-sm",H.value===a.value?"bg-green-900 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"]),title:a.label},[o("span",yr,y(a.icon),1),o("span",xr,y(a.label),1)],10,hr)),64))])])):L("",!0),x(I)?(v(),g("div",br,[o("div",wr,[oe(x(so),{class:"h-5 w-5 text-green-900"}),o("div",kr,[o("p",_r,y(p.value.nickname),1),o("p",Sr,y(p.value.role),1)])])])):L("",!0),x(I)&&x(z)&&!fe.value?(v(),g("div",Mr,[o("div",Cr,[t[34]||(t[34]=o("h3",{class:"text-xs font-semibold text-white"},"Route Info",-1)),o("button",{onClick:t[10]||(t[10]=a=>z.value=null),class:"flex h-5 w-5 items-center justify-center rounded text-gray-400 transition hover:text-white"}," √ó ")]),o("p",Er,y(x(z)),1)])):L("",!0),x(N)&&!fe.value?(v(),g("div",Lr,[o("div",Pr,[t[35]||(t[35]=o("h3",{class:"text-xs font-semibold text-white"},"Navigation",-1)),o("button",{onClick:t[11]||(t[11]=a=>N.value=!1),class:"flex h-5 w-5 items-center justify-center rounded text-gray-400 transition hover:text-white"}," √ó ")]),o("div",{ref_key:"navigationInstructionsContainer",ref:ge,class:"overflow-y-auto"},[(v(!0),g(ye,null,xe(x($),(a,u)=>(v(),g("div",{key:u,class:"flex items-start gap-2 border-b border-gray-100 px-3 py-2 text-xs last:border-b-0"},[o("span",Ir,y(a.icon),1),o("div",Nr,[o("p",$r,y(a.text),1),o("p",Ar,y(a.distance),1)])]))),128))],512)])):L("",!0)]),x(O)?(v(),g("div",Fr,[o("div",Tr,[x(b)===1?(v(),g("div",Dr,[t[36]||(t[36]=Qt('<div class="mb-6 text-center sm:mb-8" data-v-624c0f1a><div class="flex items-center justify-center gap-3 mb-4" data-v-624c0f1a><div class="h-12 w-12 bg-green-900 rounded-full flex items-center justify-center p-1.5 shadow-md" data-v-624c0f1a><img src="'+eo+'" alt="ASSCAT Logo" class="h-full w-full object-contain" data-v-624c0f1a></div><div class="flex flex-col items-start" data-v-624c0f1a><span class="text-lg font-bold text-green-900" data-v-624c0f1a>ASSCAT</span><span class="text-xs font-medium text-gray-600" data-v-624c0f1a>Campus Navigator</span></div></div><h2 class="mb-2 text-xl font-bold text-gray-900 sm:text-2xl" data-v-624c0f1a>Welcome to ASSCAT Campus Navigator</h2><p class="text-xs text-gray-500 sm:text-sm" data-v-624c0f1a>Let&#39;s get started with your nickname</p></div>',1)),o("div",Rr,[je(o("input",{"onUpdate:modelValue":t[12]||(t[12]=a=>p.value.nickname=a),type:"text",placeholder:"Enter your nickname",maxlength:"50",class:"w-full rounded-lg border border-gray-300 px-4 py-3 text-sm text-gray-900 focus:border-green-900 focus:outline-none focus:ring-1 focus:ring-green-900 sm:text-base",onKeyup:mt(ct,["enter"])},null,544),[[Be,p.value.nickname]]),o("button",{onClick:ct,disabled:!p.value.nickname.trim(),class:Se(["w-full rounded-lg px-4 py-3 text-sm font-medium transition",p.value.nickname.trim()?"bg-green-900 text-white hover:bg-green-800":"cursor-not-allowed bg-gray-200 text-gray-400"])}," Continue ",10,zr)])])):x(b)===2?(v(),g("div",Gr,[t[37]||(t[37]=o("div",{class:"mb-6 text-center sm:mb-8"},[o("h2",{class:"mb-2 text-xl font-bold text-gray-900 sm:text-2xl"},"Select Your Role"),o("p",{class:"text-xs text-gray-500 sm:text-sm"},"How are you visiting our campus?")],-1)),o("div",jr,[(v(),g(ye,null,xe(wt,a=>o("button",{key:a.value,onClick:u=>p.value.role=a.value,class:Se(["flex w-full items-center gap-3 rounded-lg border-2 px-4 py-3 transition",p.value.role===a.value?"border-green-700 bg-green-50":"border-gray-200 hover:border-gray-300"])},[o("span",Or,y(a.icon),1),o("span",Ur,y(a.label),1)],10,Br)),64))]),o("div",Vr,[o("button",{onClick:Et,disabled:!p.value.role,class:Se(["w-full rounded-lg px-4 py-3 text-sm font-medium transition",p.value.role?"bg-green-900 text-white hover:bg-green-800":"cursor-not-allowed bg-gray-200 text-gray-400"])}," Start Exploring ",10,Jr),o("button",{onClick:Ct,class:"w-full rounded-lg px-4 py-3 text-sm font-medium text-gray-600 transition hover:text-gray-900"}," Back ")])])):L("",!0)])])):L("",!0),Ye.value?(v(),g("div",{key:1,onClick:ft,class:"fixed inset-0 z-[10000] flex items-center justify-center bg-black/90 p-4"},[o("div",{onClick:t[13]||(t[13]=de(()=>{},["stop"])),class:"relative w-full max-w-5xl"},[o("button",{onClick:ft,class:"absolute -top-12 right-0 text-white hover:text-gray-300 transition"},[oe(x(Ke),{class:"h-8 w-8"})]),o("div",Hr,[ce.value[X.value]?(v(),g("img",{key:0,src:ce.value[X.value].url,alt:ce.value[X.value].caption||"Photo",class:"w-full max-h-[80vh] object-contain bg-gray-100"},null,8,Zr)):L("",!0),o("div",Kr,[ce.value[X.value]?.caption?(v(),g("p",Wr,y(ce.value[X.value].caption),1)):L("",!0),o("p",Yr,y(ce.value[X.value]?.guest?.name||"Guest")+" ‚Ä¢ "+y(Ge(ce.value[X.value]?.created_at)),1),o("p",qr," Photo "+y(X.value+1)+" of "+y(ce.value.length),1)]),X.value>0?(v(),g("button",{key:1,onClick:Jt,class:"absolute left-4 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white rounded-full p-3 shadow-lg transition"},[...t[38]||(t[38]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",class:"w-6 h-6"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})],-1)])])):L("",!0),X.value<ce.value.length-1?(v(),g("button",{key:2,onClick:Vt,class:"absolute right-4 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white rounded-full p-3 shadow-lg transition"},[...t[39]||(t[39]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",class:"w-6 h-6"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})],-1)])])):L("",!0)])])])):L("",!0)])}}},Qr=oo(Xr,[["__scopeId","data-v-624c0f1a"]]),es={class:"w-full h-screen overflow-hidden"},cs={__name:"Index",props:{facilities:{type:Array,default:()=>[]},notes:{type:Array,default:()=>[]},polygons:{type:Array,default:()=>[]}},setup(V){return(F,m)=>(v(),g("div",null,[o("div",es,[oe(Qr,{facilities:V.facilities,notes:V.notes,polygons:V.polygons},null,8,["facilities","notes","polygons"])])]))}};export{cs as default};
