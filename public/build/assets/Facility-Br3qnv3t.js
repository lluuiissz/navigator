import{c as r,o as l,a as e,u as he,r as c,b as K,d as X,w as P,e as a,t as n,f as R,g as v,h as p,v as re,i as Y,n as B,F as A,j as M,k as w,T as N,l as ne,m as ye,p as O}from"./app-C6WeSLEk.js";import{A as we}from"./AuthenticatedLayout-CzHf-vBy.js";import{_ as Z}from"./TextInput-D93sERXj.js";import{_ as _e}from"./_plugin-vue_export-helper-ElPvdbUZ.js";import{r as ke}from"./MagnifyingGlassIcon-BBKn8LIa.js";import{r as L}from"./XMarkIcon-DUyFY8fk.js";import{r as H}from"./ArrowPathIcon-niwkMT8S.js";import{r as Ce,a as De}from"./PlusIcon-DCdt4HXh.js";import{r as Fe}from"./EyeIcon-s3rhyjeN.js";/* empty css            */import"./logo-C5fiQHXv.js";function je(z,U){return l(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 21h19.5m-18-18v18m10.5-18v18m6-13.5V21M6.75 6.75h.75m-.75 3h.75m-.75 3h.75m3-6h.75m-.75 3h.75m-.75 3h.75M6.75 21v-3.375c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21M3 3h12m-.75 4.5H21m-3.75 3.75h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Z"})])}function ee(z,U){return l(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})])}const Ve={class:"py-4 max-w-7xl mx-auto sm:px-4 bg-white min-h-screen"},Pe={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6"},$e={class:"mt-4 sm:mt-0"},Ae={class:"text-sm text-green-700 font-medium"},Me={class:"flex flex-col sm:flex-row gap-3 mb-6"},Ne={class:"relative flex-1 max-w-md"},Le={class:"flex gap-2 ml-auto"},Ue=["disabled"],Se={class:"bg-white border border-green-200 rounded-lg overflow-hidden"},Ee={key:0,class:"text-center py-12"},Te={key:1,class:"text-center py-12"},Re={key:2,class:"columns-1 sm:columns-2 lg:columns-3 xl:columns-4 gap-4 p-6 space-y-4"},Be={class:"flex items-start justify-between mb-3"},Oe={class:"text-sm font-semibold text-green-900"},Ze={class:"text-xs text-green-700 mt-1"},ze=["onClick"],Ie={class:"mb-3 space-y-2"},qe={class:"text-sm text-gray-700"},He={class:"text-sm text-gray-700"},Ge={class:"mb-3"},We={key:0,class:"grid grid-cols-2 gap-2"},Je=["src","alt"],Qe={key:0,class:"relative"},Ke=["src"],Xe=["onClick"],Ye={key:1,class:"flex items-center justify-center py-4 border-2 border-dashed border-green-300 rounded-lg bg-green-50"},et={class:"text-center"},tt={class:"mb-3 flex items-center justify-between text-xs"},st={class:"text-gray-600"},ot={class:"flex gap-2 pt-3 border-t border-green-100"},lt=["onClick"],rt=["onClick"],nt={class:"p-5 border-b border-green-200 bg-green-50"},at={class:"flex items-center justify-between"},it={class:"text-lg font-semibold text-green-900"},dt={class:"p-5 overflow-y-auto max-h-[calc(75vh-140px)] space-y-4"},ut={class:"grid grid-cols-2 gap-4"},ct={class:"text-sm text-gray-700"},gt={class:"text-sm text-gray-700"},pt={class:"text-sm text-gray-700"},vt={key:0},mt={class:"text-xs font-semibold text-green-900 mb-2 uppercase tracking-wide"},bt={class:"grid grid-cols-3 gap-2"},xt=["src","alt"],ft=["onClick"],ht={key:1},yt={class:"p-3 bg-green-50 rounded-lg border border-green-200"},wt={class:"font-medium text-green-900 text-sm"},_t={class:"text-xs text-green-700 mt-1"},kt={class:"text-xs text-gray-600 mt-2"},Ct={key:2},Dt={class:"p-3 bg-green-50 rounded-lg border border-green-200"},Ft={class:"text-sm text-gray-700 whitespace-pre-wrap"},jt={class:"p-6"},Vt={class:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 rounded-full"},Pt={class:"text-sm text-gray-600 text-center mb-4"},$t={class:"font-semibold text-gray-900"},At={class:"bg-gray-50 rounded-lg p-4 mb-6 space-y-2 text-sm"},Mt={class:"flex justify-between"},Nt={class:"font-medium text-gray-900"},Lt={class:"flex justify-between"},Ut={class:"font-medium text-gray-900"},St={class:"flex justify-between"},Et={class:"flex gap-3"},Tt=["disabled"],Rt=["disabled"],Bt={class:"p-5 border-b border-green-200 bg-green-50"},Ot={class:"flex items-center justify-between"},Zt={class:"text-lg font-semibold text-green-900"},zt=["disabled"],It={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},qt=["value"],Ht={class:"md:col-span-2"},Gt={class:"flex flex-col items-center justify-center cursor-pointer"},Wt={key:0,class:"bg-white border border-green-200 rounded-lg p-3 space-y-3"},Jt={key:0,class:"grid grid-cols-2 gap-2"},Qt=["src","alt"],Kt=["onClick"],Xt=["src","alt"],Yt=["onClick"],es={key:0,class:"relative group"},ts=["src"],ss={class:"absolute inset-0 w-full h-full flex items-center justify-center bg-green-900/40 rounded text-white font-medium text-sm"},os={key:1,class:"flex flex-col items-center justify-center py-6 border-2 border-dashed border-green-300 rounded-lg bg-green-50"},ls={class:"md:col-span-2"},rs={class:"p-5 border-t border-green-200 flex gap-3 justify-end"},ns=["disabled"],as=["disabled"],is={__name:"Facility",props:{markers:{type:Array,default:()=>[]},facilities:{type:Array,default:()=>[]},pagination:{type:Object,default:()=>({current_page:1,last_page:1,total:0,per_page:10,from:1,to:1})}},setup(z){const U=z,_=he(),k=c(""),F=c("all"),$=c(!1),S=c(!1),d=c({name:"",category:"",department:"",floor_number:"",description:"",hours:"",status:"active",marker_id:null}),C=c(!1),g=c(null),E=c(!1),u=c(null),y=c(!1),D=c(!1),j=c([]),m=c([]),x=c([]),f=c([]),te=c(!1),G=c(!1),I=c(!1),q=K(()=>{let o=U.facilities;if(k.value){const t=k.value.toLowerCase();o=o.filter(s=>{const i=s.name?.toLowerCase()||"",h=s.category?.toLowerCase()||"",V=s.department?.toLowerCase()||"";return i.includes(t)||h.includes(t)||V.includes(t)})}if(F.value&&F.value!=="all"){const t=F.value.toLowerCase();o=o.filter(s=>s.status?.toLowerCase()===t)}return o}),ae=K(()=>k.value||F.value!=="all"),T=c(!1),W=()=>{T.value=!0,ye.reload({preserveState:!0,onFinish:()=>{T.value=!1}})},ie=()=>{g.value=null,C.value=!1,d.value={name:"",category:"",department:"",description:"",hours:"",status:"active",marker_id:null},j.value=[],m.value=[],x.value=[],f.value=[],G.value=!1,$.value=!0},de=o=>{g.value=o,C.value=!0,d.value={name:o.name,category:o.category,department:o.department,description:o.description,floor_number:o.floor_number,hours:o.hours,status:o.status,marker_id:o.marker_id||null},j.value=[],m.value=[],x.value=o.photos||[],f.value=[],G.value=!1,$.value=!0},ue=o=>{g.value=o,S.value=!0},ce=async()=>{if(!(!g.value||D.value)){D.value=!0;try{const o=await O.delete(`/facilities/${g.value.id}/destroy`);S.value=!1,g.value=null,_.success(o.data.message||"Facility deleted successfully!"),W()}catch(o){console.error("Delete error:",o.response?.data),_.error(o.response?.data?.message||"Failed to delete facility.")}finally{D.value=!1}}},se=()=>{D.value||(S.value=!1,g.value=null)},ge=o=>{u.value=o,E.value=!0},J=()=>{E.value=!1,u.value=null},pe=o=>{const t=o.target.files[0];if(t&&t.type.startsWith("image/")){const s=new FileReader;s.onload=i=>{m.value.push({url:i.target.result,file:t,isNew:!0}),j.value.push(t)},s.readAsDataURL(t)}o.target.value=""},ve=o=>{o.preventDefault(),o.stopPropagation(),I.value=!1;const t=o.dataTransfer.files[0];if(t&&t.type.startsWith("image/")){const s=new FileReader;s.onload=i=>{m.value.push({url:i.target.result,file:t,isNew:!0}),j.value.push(t)},s.readAsDataURL(t)}},me=o=>{o.preventDefault(),o.stopPropagation(),I.value=!0},be=o=>{o.preventDefault(),o.stopPropagation(),I.value=!1},xe=o=>{m.value.splice(o,1),j.value.splice(o,1)},oe=o=>{const t=x.value.findIndex(s=>s.id===o);t!==-1&&(f.value.push(o),x.value.splice(t,1))},le=async()=>{if(!y.value){y.value=!0;try{let o;if(C.value&&g.value?(await O.put(`/facilities/${g.value.id}`,d.value),o=g.value.id,_.success("Facility updated successfully!")):(o=(await O.post("/facilities",d.value)).data.facility.id,_.success("Facility created successfully!")),j.value.length>0&&o){te.value=!0;const t=new FormData;j.value.forEach((s,i)=>{t.append(`photos[${i}]`,s)});try{await O.post(`/facilities/${o}/photos/bulk`,t,{headers:{"Content-Type":"multipart/form-data"}}),_.success("Photos uploaded successfully!")}catch(s){console.error("Photo upload error:",s),_.error("Facility saved but some photos failed to upload")}finally{te.value=!1}}if(f.value.length>0&&o)try{await O.post(`/facilities/${o}/photos/delete`,{photo_ids:f.value})}catch(t){console.error("Photo deletion error:",t)}$.value=!1,W()}catch(o){if(console.error("Save errors:",o.response?.data),o.response?.data?.errors){const t=o.response.data.errors,s=Object.values(t)[0][0];_.error(s)}else _.error(o.response?.data?.message||`Failed to ${C.value?"update":"create"} facility.`)}finally{y.value=!1}}},Q=()=>{y.value||($.value=!1,g.value=null,C.value=!1)},fe=()=>{k.value="",F.value="all"};return K(()=>{const o=U.pagination.current_page,t=U.pagination.last_page,s=2,i=[],h=[];for(let b=1;b<=t;b++)(b===1||b===t||b>=o-s&&b<=o+s)&&i.push(b);let V=0;for(let b of i)V&&(b-V===2?h.push(V+1):b-V!==1&&h.push("...")),h.push(b),V=b;return h}),(o,t)=>(l(),X(we,null,{default:P(()=>[e("div",Ve,[e("div",Pe,[t[14]||(t[14]=e("div",null,[e("h2",{class:"text-2xl font-bold text-green-900"},"Facilities"),e("p",{class:"mt-1 text-sm text-green-700"},"Manage campus facilities and locations")],-1)),e("div",$e,[e("span",Ae,n(q.value.length)+" "+n(q.value.length===1?"facility":"facilities"),1)])]),e("div",Me,[e("div",Ne,[a(p(ke),{class:"absolute left-3 top-2.5 h-4 w-4 text-green-700"}),R(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>k.value=s),type:"text",placeholder:"Search facilities, category, or department...",class:"w-full pl-9 pr-8 py-2 border border-green-300 rounded-lg text-sm focus:border-green-900 focus:outline-none focus:ring-1 focus:ring-green-900"},null,512),[[re,k.value]]),k.value?(l(),r("button",{key:0,onClick:t[1]||(t[1]=s=>k.value=""),type:"button",class:"absolute right-3 top-2.5 text-green-600 hover:text-green-900 transition-colors"},[a(p(L),{class:"w-4 h-4"})])):v("",!0)]),R(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>F.value=s),class:"px-3 py-2 border border-green-300 rounded-lg text-sm focus:border-green-900 focus:outline-none focus:ring-1 focus:ring-green-900"},[...t[15]||(t[15]=[e("option",{value:"all"},"All Status",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1)])],512),[[Y,F.value]]),ae.value?(l(),r("button",{key:0,onClick:fe,class:"px-4 py-2 bg-green-900 text-white rounded-lg text-sm font-medium hover:bg-green-800 transition-colors"}," Clear Filters ")):v("",!0),e("div",Le,[e("button",{onClick:W,disabled:T.value,type:"button",class:"p-2 text-green-700 hover:text-green-900 hover:bg-green-50 rounded-lg transition disabled:opacity-50"},[a(p(H),{class:B(["h-4 w-4",T.value?"animate-spin":""])},null,8,["class"])],8,Ue),e("button",{onClick:ie,type:"button",class:"flex items-center gap-2 px-4 py-2 text-sm text-white bg-green-900 hover:bg-green-800 rounded-lg transition"},[a(p(Ce),{class:"h-4 w-4"}),t[16]||(t[16]=e("span",null,"Create Facility",-1))])])]),e("div",Se,[T.value?(l(),r("div",Ee,[a(p(H),{class:"h-6 w-6 animate-spin mx-auto text-green-600 mb-2"}),t[17]||(t[17]=e("p",{class:"text-sm text-green-700"},"Loading...",-1))])):q.value.length===0?(l(),r("div",Te,[a(p(je),{class:"h-8 w-8 mx-auto text-green-300 mb-2"}),t[18]||(t[18]=e("h3",{class:"text-lg font-semibold text-green-900 mb-2"},"No facilities found",-1)),t[19]||(t[19]=e("p",{class:"text-sm text-gray-600"},"Try adjusting your filters or create a new facility",-1))])):(l(),r("div",Re,[(l(!0),r(A,null,M(q.value,s=>(l(),r("div",{key:s.id,class:"break-inside-avoid bg-white border border-green-200 rounded-lg p-4 hover:shadow-lg hover:border-green-300 transition-all duration-200 cursor-pointer group"},[e("div",Be,[e("div",null,[e("h3",Oe,n(s.name),1),e("p",Ze,n(s.category),1)]),e("button",{onClick:w(i=>ge(s),["stop"]),class:"opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-green-50 rounded"},[a(p(Fe),{class:"w-4 h-4 text-green-900"})],8,ze)]),e("div",Ie,[e("div",null,[t[20]||(t[20]=e("p",{class:"text-xs font-semibold text-green-900"},"Department",-1)),e("p",qe,n(s.department),1)]),e("div",null,[t[21]||(t[21]=e("p",{class:"text-xs font-semibold text-green-900"},"ðŸ“ Location",-1)),e("p",He,n(s.marker?s.marker.label:"N/A"),1)])]),e("div",Ge,[t[23]||(t[23]=e("p",{class:"text-xs font-semibold text-green-900 mb-2"},"Photos",-1)),s.photos&&s.photos.length>0?(l(),r("div",We,[(l(!0),r(A,null,M(s.photos.slice(0,2),(i,h)=>(l(),r("div",{key:i.id,class:"relative"},[e("img",{src:i.url,alt:"Photo "+(h+1),class:"w-full h-20 object-cover rounded border border-green-200"},null,8,Je)]))),128)),s.photos.length>2?(l(),r("div",Qe,[e("img",{src:s.photos[2].url,alt:"Photo 3",class:"w-full h-20 object-cover rounded border border-green-200 opacity-40"},null,8,Ke),e("button",{onClick:w(i=>{u.value=s,E.value=!0,G.value=!0},["stop"]),class:"absolute inset-0 w-full h-full flex items-center justify-center bg-green-900/40 hover:bg-green-900/60 transition rounded text-white font-medium text-sm"}," +"+n(s.photos.length-2)+" More ",9,Xe)])):v("",!0)])):(l(),r("div",Ye,[e("div",et,[a(p(ee),{class:"w-6 h-6 text-green-700 mx-auto mb-1"}),t[22]||(t[22]=e("p",{class:"text-xs text-green-700"},"No photos added",-1))])]))]),e("div",tt,[e("div",null,[e("p",st,n(s.hours||"N/A"),1)]),e("span",{class:B(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",s.status==="active"?"bg-green-50 text-green-900":"bg-gray-200 text-gray-700"])},n(s.status),3)]),e("div",ot,[e("button",{onClick:w(i=>de(s),["stop"]),class:"flex-1 px-3 py-2 text-xs font-medium text-green-900 bg-green-50 hover:bg-green-100 rounded transition",type:"button"}," Edit ",8,lt),e("button",{onClick:w(i=>ue(s),["stop"]),class:"flex-1 px-3 py-2 text-xs font-medium text-red-600 bg-red-50 hover:bg-red-100 rounded transition",type:"button"}," Delete ",8,rt)])]))),128))]))])]),a(N,{name:"modal-fade"},{default:P(()=>[E.value?(l(),r("div",{key:0,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",onClick:J},[a(N,{name:"modal-scale"},{default:P(()=>[E.value?(l(),r("div",{key:0,class:"bg-white rounded-lg shadow-lg w-full max-w-xl max-h-[75vh] overflow-hidden",onClick:t[3]||(t[3]=w(()=>{},["stop"]))},[e("div",nt,[e("div",at,[e("h3",it,n(u.value?.name),1),e("button",{onClick:J,type:"button",class:"text-green-700 hover:text-green-900 transition-colors"},[a(p(L),{class:"w-5 h-5"})])])]),e("div",dt,[e("div",ut,[e("div",null,[t[24]||(t[24]=e("h4",{class:"text-xs font-semibold text-green-900 mb-1 uppercase tracking-wide"},"Category",-1)),e("p",ct,n(u.value?.category),1)]),e("div",null,[t[25]||(t[25]=e("h4",{class:"text-xs font-semibold text-green-900 mb-1 uppercase tracking-wide"},"Department",-1)),e("p",gt,n(u.value?.department),1)]),e("div",null,[t[26]||(t[26]=e("h4",{class:"text-xs font-semibold text-green-900 mb-1 uppercase tracking-wide"},"Hours",-1)),e("p",pt,n(u.value?.hours||"N/A"),1)]),e("div",null,[t[27]||(t[27]=e("h4",{class:"text-xs font-semibold text-gray-900 mb-1 uppercase tracking-wide"},"Status",-1)),e("span",{class:B(["inline-flex px-2 py-0.5 text-xs font-semibold rounded",g.value?.status==="active"?"bg-green-50 text-green-900":"bg-gray-200 text-gray-700"])},n(g.value?.status),3)])]),u.value?.photos&&u.value?.photos.length>0?(l(),r("div",vt,[e("h4",mt,"Photos ("+n(u.value.photos.length)+")",1),e("div",bt,[(l(!0),r(A,null,M(u.value.photos,(s,i)=>(l(),r("div",{key:s.id,class:"relative group"},[e("img",{src:s.url,alt:"Photo "+(i+1),class:"w-full h-24 object-cover rounded border border-green-200"},null,8,xt),e("button",{onClick:w(h=>{oe(s.id),u.value.photos.splice(i,1)},["stop"]),type:"button",class:"absolute top-1 right-1 p-1 bg-red-600 text-white rounded-full hover:bg-red-700 transition opacity-0 group-hover:opacity-100",title:"Remove photo"},[a(p(L),{class:"w-3 h-3"})],8,ft)]))),128))])])):v("",!0),u.value?.marker?(l(),r("div",ht,[t[28]||(t[28]=e("h4",{class:"text-xs font-semibold text-green-900 mb-2 uppercase tracking-wide"},"Location",-1)),e("div",yt,[e("p",wt,n(u.value.marker.label),1),e("p",_t,n(u.value.marker.type),1),e("p",kt,"Lat: "+n(u.value.marker.latitude)+", Lng: "+n(u.value.marker.longitude),1)])])):v("",!0),u.value?.description?(l(),r("div",Ct,[t[29]||(t[29]=e("h4",{class:"text-xs font-semibold text-green-900 mb-2 uppercase tracking-wide"},"Description",-1)),e("div",Dt,[e("p",Ft,n(u.value.description),1)])])):v("",!0)]),e("div",{class:"p-5 border-t border-green-200"},[e("button",{onClick:J,class:"w-full px-4 py-2 bg-green-900 text-white rounded-lg text-sm font-medium hover:bg-green-800 transition-colors"}," Close ")])])):v("",!0)]),_:1})])):v("",!0)]),_:1}),a(N,{name:"modal-fade"},{default:P(()=>[S.value?(l(),r("div",{key:0,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",onClick:se},[a(N,{name:"modal-scale"},{default:P(()=>[S.value?(l(),r("div",{key:0,class:"bg-white rounded-lg shadow-lg w-full max-w-md",onClick:t[4]||(t[4]=w(()=>{},["stop"]))},[e("div",jt,[e("div",Vt,[a(p(De),{class:"w-6 h-6 text-red-600"})]),t[35]||(t[35]=e("h3",{class:"text-lg font-semibold text-gray-900 text-center mb-2"},"Delete Facility",-1)),e("p",Pt,[t[30]||(t[30]=ne(" Are you sure you want to delete ",-1)),e("span",$t,n(g.value?.name),1),t[31]||(t[31]=ne("? ",-1))]),e("div",At,[e("div",Mt,[t[32]||(t[32]=e("span",{class:"text-gray-600"},"Category:",-1)),e("span",Nt,n(g.value?.category),1)]),e("div",Lt,[t[33]||(t[33]=e("span",{class:"text-gray-600"},"Department:",-1)),e("span",Ut,n(g.value?.department),1)]),e("div",St,[t[34]||(t[34]=e("span",{class:"text-gray-600"},"Status:",-1)),e("span",{class:B(["inline-flex px-2 py-0.5 text-xs font-semibold rounded",g.value?.status==="active"?"bg-gray-100 text-gray-900":"bg-gray-200 text-gray-700"])},n(g.value?.status),3)])]),e("div",Et,[e("button",{onClick:se,disabled:D.value,type:"button",class:"flex-1 px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 hover:bg-gray-50 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed"}," Cancel ",8,Tt),e("button",{onClick:ce,disabled:D.value,type:"button",class:"flex-1 px-4 py-2.5 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[D.value?(l(),X(p(H),{key:0,class:"w-4 h-4 animate-spin"})):v("",!0),e("span",null,n(D.value?"Deleting...":"Delete"),1)],8,Rt)])])])):v("",!0)]),_:1})])):v("",!0)]),_:1}),a(N,{name:"modal-fade"},{default:P(()=>[$.value?(l(),r("div",{key:0,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",onClick:Q},[a(N,{name:"modal-scale"},{default:P(()=>[$.value?(l(),r("div",{key:0,class:"bg-white rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",onClick:t[13]||(t[13]=w(()=>{},["stop"]))},[e("div",Bt,[e("div",Ot,[e("h3",Zt,n(C.value?"Edit Facility":"Add Facility"),1),e("button",{onClick:Q,disabled:y.value,type:"button",class:"text-green-700 hover:text-green-900 transition-colors disabled:opacity-50"},[a(p(L),{class:"w-5 h-5"})],8,zt)])]),e("form",{onSubmit:w(le,["prevent"]),class:"p-5 overflow-y-auto max-h-[calc(90vh-140px)]"},[e("div",It,[e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-green-900 mb-1"},"Name",-1)),a(Z,{modelValue:d.value.name,"onUpdate:modelValue":t[5]||(t[5]=s=>d.value.name=s),type:"text",placeholder:"Facility name",required:"",class:"w-full px-4 py-2 text-sm border border-green-300 rounded-lg focus:border-green-900 focus:outline-none focus:ring-1 focus:ring-green-900"},null,8,["modelValue"])]),e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-green-900 mb-1"},"Category",-1)),a(Z,{modelValue:d.value.category,"onUpdate:modelValue":t[6]||(t[6]=s=>d.value.category=s),type:"text",placeholder:"Category",required:"",class:"w-full px-4 py-2 text-sm border border-green-300 rounded-lg focus:border-green-900 focus:outline-none focus:ring-1 focus:ring-green-900"},null,8,["modelValue"])]),e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-green-900 mb-1"},"Department",-1)),a(Z,{modelValue:d.value.department,"onUpdate:modelValue":t[7]||(t[7]=s=>d.value.department=s),type:"text",placeholder:"Department",required:"",class:"w-full px-4 py-2 text-sm border border-green-300 rounded-lg focus:border-green-900 focus:outline-none focus:ring-1 focus:ring-green-900"},null,8,["modelValue"])]),e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-green-900 mb-1"},"Floor Number",-1)),a(Z,{modelValue:d.value.floor_number,"onUpdate:modelValue":t[8]||(t[8]=s=>d.value.floor_number=s),type:"text",placeholder:"Floor Number",class:"w-full px-4 py-2 text-sm border border-green-300 rounded-lg focus:border-green-900 focus:outline-none focus:ring-1 focus:ring-green-900"},null,8,["modelValue"])]),e("div",null,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-green-900 mb-1"},"Hours",-1)),a(Z,{modelValue:d.value.hours,"onUpdate:modelValue":t[9]||(t[9]=s=>d.value.hours=s),type:"text",placeholder:"9:00 AM - 5:00 PM",class:"w-full px-4 py-2 text-sm border border-green-300 rounded-lg focus:border-green-900 focus:outline-none focus:ring-1 focus:ring-green-900"},null,8,["modelValue"])]),e("div",null,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-green-900 mb-1"},"Status",-1)),R(e("select",{"onUpdate:modelValue":t[10]||(t[10]=s=>d.value.status=s),class:"w-full px-4 py-2 text-sm border border-green-300 rounded-lg focus:border-green-900 focus:outline-none focus:ring-1 focus:ring-green-900"},[...t[41]||(t[41]=[e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1)])],512),[[Y,d.value.status]])]),e("div",null,[t[44]||(t[44]=e("label",{class:"block text-sm font-medium text-green-900 mb-1"},"Marker",-1)),R(e("select",{"onUpdate:modelValue":t[11]||(t[11]=s=>d.value.marker_id=s),class:"w-full px-4 py-2 text-sm border border-green-300 rounded-lg focus:border-green-900 focus:outline-none focus:ring-1 focus:ring-green-900"},[t[43]||(t[43]=e("option",{value:null},"Select a marker",-1)),(l(!0),r(A,null,M(z.markers,s=>(l(),r("option",{key:s.id,value:s.id},n(s.label)+" - "+n(s.type),9,qt))),128))],512),[[Y,d.value.marker_id]])]),e("div",Ht,[t[50]||(t[50]=e("label",{class:"block text-sm font-medium text-green-900 mb-2"},"Photos",-1)),e("div",{onDrop:ve,onDragover:me,onDragleave:be,class:B(["mb-3 p-6 border-2 border-dashed rounded-lg transition-colors cursor-pointer",I.value.value?"border-green-500 bg-green-50":"border-green-300 hover:border-green-400"])},[e("label",Gt,[a(p(ee),{class:"w-8 h-8 text-green-700 mb-2"}),t[45]||(t[45]=e("span",{class:"text-sm font-medium text-green-900"},"Drag & drop photo or",-1)),t[46]||(t[46]=e("span",{class:"text-sm text-green-700 hover:text-green-900"},"browse",-1)),t[47]||(t[47]=e("p",{class:"text-xs text-green-700 mt-1"},"Add one photo at a time (PNG, JPG, GIF)",-1)),e("input",{type:"file",onChange:pe,accept:"image/*",class:"hidden"},null,32)])],34),m.value.length>0||x.value.length>0?(l(),r("div",Wt,[m.value.length>0||x.value.filter(s=>!f.value.includes(s.id)).length>0?(l(),r("div",Jt,[(l(!0),r(A,null,M(x.value.filter(s=>!f.value.includes(s.id)).slice(0,2),(s,i)=>(l(),r("div",{key:"existing-"+s.id,class:"relative group"},[e("img",{src:s.url,alt:"Photo "+(i+1),class:"w-full h-16 object-cover rounded border border-green-200"},null,8,Qt),e("button",{onClick:h=>oe(s.id),type:"button",class:"absolute top-1 right-1 p-1 bg-red-600 text-white rounded-full hover:bg-red-700 transition opacity-0 group-hover:opacity-100",title:"Remove photo"},[a(p(L),{class:"w-3 h-3"})],8,Kt)]))),128)),(l(!0),r(A,null,M(m.value.slice(0,2-Math.min(2,x.value.filter(s=>!f.value.includes(s.id)).length)),(s,i)=>(l(),r("div",{key:"preview-"+i,class:"relative group"},[e("img",{src:s.url,alt:"New photo "+(i+1),class:"w-full h-16 object-cover rounded border border-green-200"},null,8,Xt),e("button",{onClick:h=>xe(i),type:"button",class:"absolute top-1 right-1 p-1 bg-red-600 text-white rounded-full hover:bg-red-700 transition opacity-0 group-hover:opacity-100",title:"Remove photo"},[a(p(L),{class:"w-3 h-3"})],8,Yt),t[48]||(t[48]=e("div",{class:"absolute bottom-1 left-1 px-1.5 py-0.5 bg-green-600 text-white text-xs font-medium rounded"}," New ",-1))]))),128)),x.value.filter(s=>!f.value.includes(s.id)).length+m.value.length>2?(l(),r("div",es,[e("img",{src:(x.value.filter(s=>!f.value.includes(s.id))[2]||m.value[2])?.url||m.value[0]?.url,alt:"Photo 3",class:"w-full h-16 object-cover rounded border border-green-200 opacity-40"},null,8,ts),e("div",ss," +"+n(x.value.filter(s=>!f.value.includes(s.id)).length+m.value.length-2),1)])):v("",!0)])):v("",!0)])):(l(),r("div",os,[a(p(ee),{class:"w-8 h-8 text-green-700 mb-2"}),t[49]||(t[49]=e("p",{class:"text-sm text-green-700"},"No photos added yet",-1))]))]),e("div",ls,[t[51]||(t[51]=e("label",{class:"block text-sm font-medium text-green-900 mb-1"},"Description",-1)),R(e("textarea",{"onUpdate:modelValue":t[12]||(t[12]=s=>d.value.description=s),rows:"4",placeholder:"Facility description",class:"w-full px-4 py-2 text-sm border border-green-300 rounded-lg focus:border-green-900 focus:outline-none focus:ring-1 focus:ring-green-900 resize-none"},null,512),[[re,d.value.description]])])])],32),e("div",rs,[e("button",{onClick:Q,disabled:y.value,type:"button",class:"px-4 py-2 text-sm font-medium text-green-900 bg-white border border-green-300 hover:bg-green-50 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed"}," Cancel ",8,ns),e("button",{onClick:le,disabled:y.value,type:"button",class:"px-4 py-2 text-sm font-medium text-white bg-green-900 hover:bg-green-800 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[y.value?(l(),X(p(H),{key:0,class:"h-4 w-4 animate-spin"})):v("",!0),e("span",null,n(y.value?C.value?"Updating...":"Creating...":C.value?"Update":"Create"),1)],8,as)])])):v("",!0)]),_:1})])):v("",!0)]),_:1})]),_:1}))}},ys=_e(is,[["__scopeId","data-v-5ae836e9"]]);export{ys as default};
